name: product_add_on_rule
primary_source_table: staging.staging_octane.product_add_on_rule
primary_key:
- par_pid
- par_version
foreign_keys:
  fk_product_loan_add_on_rule_1:
    columns:
    - par_product_add_on_pid
    references:
      columns:
      - pao_pid
      schema: history_octane
      table: product_add_on
  fkt_par_amortization_input_type:
    columns:
    - par_amortization_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_arms_length_input_type:
    columns:
    - par_arms_length_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_doc_level_input_type:
    columns:
    - par_doc_level_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_escrow_waiver_input_type:
    columns:
    - par_escrow_waiver_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_first_time_homebuyer_input_type:
    columns:
    - par_first_time_homebuyer_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_hazardous_lava_zone_input_type:
    columns:
    - par_hazardous_lava_zone_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_loan_purpose_input_type:
    columns:
    - par_loan_purpose_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_non_resident_alien_input_type:
    columns:
    - par_non_resident_alien_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_property_acres_input_type:
    columns:
    - par_property_acres_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_property_category_input_type:
    columns:
    - par_property_category_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_property_rights_input_type:
    columns:
    - par_property_rights_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_property_usage_input_type:
    columns:
    - par_property_usage_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_self_employed_input_type:
    columns:
    - par_self_employed_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_state_input_type:
    columns:
    - par_state_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
  fkt_par_subordinate_financing_input_type:
    columns:
    - par_subordinate_financing_input_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_rule_domain_input_type
columns:
  data_source_deleted_flag:
    data_type: BOOLEAN
  data_source_updated_datetime:
    data_type: TIMESTAMPTZ
  etl_batch_id:
    data_type: TEXT
  par_account_price_adjustment_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_account_price_adjustment_percent
  par_amortization_fully:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_amortization_fully
  par_amortization_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_amortization_input_type
  par_amortization_interest_only:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_amortization_interest_only
  par_arm_margin_adjustment_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_arm_margin_adjustment_percent
  par_arms_length:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_arms_length
  par_arms_length_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_arms_length_input_type
  par_doc_level_full:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_doc_level_full
  par_doc_level_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_doc_level_input_type
  par_doc_level_limited:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_doc_level_limited
  par_doc_level_lite:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_doc_level_lite
  par_doc_level_streamline_refinance:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_doc_level_streamline_refinance
  par_escrow_waiver:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_escrow_waiver
  par_escrow_waiver_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_escrow_waiver_input_type
  par_first_time_homebuyer:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_first_time_homebuyer
  par_first_time_homebuyer_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_first_time_homebuyer_input_type
  par_hazardous_lava_zone:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_hazardous_lava_zone
  par_hazardous_lava_zone_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_hazardous_lava_zone_input_type
  par_investor_price_adjustment_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_investor_price_adjustment_percent
  par_loan_purpose_cash_out:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_loan_purpose_cash_out
  par_loan_purpose_change_in_rate_term:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_loan_purpose_change_in_rate_term
  par_loan_purpose_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_loan_purpose_input_type
  par_loan_purpose_purchase:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_loan_purpose_purchase
  par_maximum_cltv_ratio_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_maximum_cltv_ratio_input
  par_maximum_cltv_ratio_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_maximum_cltv_ratio_percent
  par_maximum_credit_score:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.par_maximum_credit_score
  par_maximum_credit_score_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_maximum_credit_score_input
  par_maximum_debt_ratio_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_maximum_debt_ratio_input
  par_maximum_debt_ratio_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_maximum_debt_ratio_percent
  par_maximum_housing_ratio_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_maximum_housing_ratio_input
  par_maximum_housing_ratio_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_maximum_housing_ratio_percent
  par_maximum_loan_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.par_maximum_loan_amount
  par_maximum_loan_amount_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_maximum_loan_amount_input
  par_maximum_ltv_ratio_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_maximum_ltv_ratio_input
  par_maximum_ltv_ratio_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_maximum_ltv_ratio_percent
  par_minimum_cltv_ratio_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_minimum_cltv_ratio_input
  par_minimum_cltv_ratio_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_minimum_cltv_ratio_percent
  par_minimum_credit_score:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.par_minimum_credit_score
  par_minimum_credit_score_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_minimum_credit_score_input
  par_minimum_debt_ratio_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_minimum_debt_ratio_input
  par_minimum_debt_ratio_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_minimum_debt_ratio_percent
  par_minimum_loan_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.par_minimum_loan_amount
  par_minimum_loan_amount_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_minimum_loan_amount_input
  par_minimum_ltv_ratio_input:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_minimum_ltv_ratio_input
  par_minimum_ltv_ratio_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_minimum_ltv_ratio_percent
  par_non_resident_alien:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_non_resident_alien
  par_non_resident_alien_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_non_resident_alien_input_type
  par_not_arms_length:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_not_arms_length
  par_not_escrow_waiver:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_not_escrow_waiver
  par_not_first_time_homebuyer:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_not_first_time_homebuyer
  par_not_hazardous_lava_zone:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_not_hazardous_lava_zone
  par_not_non_resident_alien:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_not_non_resident_alien
  par_not_self_employed:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_not_self_employed
  par_not_subordinate_financing:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_not_subordinate_financing
  par_not_under_10_acres:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_not_under_10_acres
  par_note:
    data_type: VARCHAR(256)
    source:
      field: primary_source_table.columns.par_note
  par_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.par_pid
  par_product_add_on_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.par_product_add_on_pid
  par_property_acres_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_property_acres_input_type
  par_property_category_attached:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_attached
  par_property_category_commercial_residential:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_commercial_residential
  par_property_category_condo_1_to_4_story:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_condo_1_to_4_story
  par_property_category_condo_5_over_story:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_condo_5_over_story
  par_property_category_condo_hotel:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_condo_hotel
  par_property_category_detached:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_detached
  par_property_category_duplex:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_duplex
  par_property_category_farm:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_farm
  par_property_category_fourplex:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_fourplex
  par_property_category_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_property_category_input_type
  par_property_category_land_and_lots:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_land_and_lots
  par_property_category_manufactured_multi_wide:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_manufactured_multi_wide
  par_property_category_manufactured_single_wide:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_manufactured_single_wide
  par_property_category_townhouse_rowhouse:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_townhouse_rowhouse
  par_property_category_triplex:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_category_triplex
  par_property_rights_fee_simple:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_rights_fee_simple
  par_property_rights_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_property_rights_input_type
  par_property_rights_leasehold:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_rights_leasehold
  par_property_usage_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_property_usage_input_type
  par_property_usage_investment:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_usage_investment
  par_property_usage_primary_residence:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_usage_primary_residence
  par_property_usage_second_home:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_property_usage_second_home
  par_rate_adjustment_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.par_rate_adjustment_percent
  par_self_employed:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_self_employed
  par_self_employed_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_self_employed_input_type
  par_state_ak:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ak
  par_state_al:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_al
  par_state_ar:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ar
  par_state_az:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_az
  par_state_ca:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ca
  par_state_co:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_co
  par_state_ct:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ct
  par_state_dc:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_dc
  par_state_de:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_de
  par_state_fl:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_fl
  par_state_ga:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ga
  par_state_gu:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_gu
  par_state_hi:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_hi
  par_state_ia:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ia
  par_state_id:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_id
  par_state_il:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_il
  par_state_in:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_in
  par_state_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_state_input_type
  par_state_ks:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ks
  par_state_ky:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ky
  par_state_la:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_la
  par_state_ma:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ma
  par_state_md:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_md
  par_state_me:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_me
  par_state_mi:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_mi
  par_state_mn:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_mn
  par_state_mo:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_mo
  par_state_ms:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ms
  par_state_mt:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_mt
  par_state_nc:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_nc
  par_state_nd:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_nd
  par_state_ne:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ne
  par_state_nh:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_nh
  par_state_nj:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_nj
  par_state_nm:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_nm
  par_state_nv:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_nv
  par_state_ny:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ny
  par_state_oh:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_oh
  par_state_ok:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ok
  par_state_or:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_or
  par_state_pa:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_pa
  par_state_pr:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_pr
  par_state_ri:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ri
  par_state_sc:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_sc
  par_state_sd:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_sd
  par_state_tn:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_tn
  par_state_tx:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_tx
  par_state_ut:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_ut
  par_state_va:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_va
  par_state_vi:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_vi
  par_state_vt:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_vt
  par_state_wa:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_wa
  par_state_wi:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_wi
  par_state_wv:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_wv
  par_state_wy:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_state_wy
  par_subordinate_financing:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_subordinate_financing
  par_subordinate_financing_input_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.par_subordinate_financing_input_type
  par_summary:
    data_type: VARCHAR(16000)
    source:
      field: primary_source_table.columns.par_summary
  par_under_10_acres:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.par_under_10_acres
  par_version:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.par_version
etls:
  SP-100108:
    input_type: table
    output_type: insert
    json_output_field: par_pid
    truncate_table: false
    input_sql: |-
      --finding records to insert into history_octane.product_add_on_rule
      SELECT staging_table.par_pid
           , staging_table.par_version
           , staging_table.par_product_add_on_pid
           , staging_table.par_summary
           , staging_table.par_note
           , staging_table.par_rate_adjustment_percent
           , staging_table.par_investor_price_adjustment_percent
           , staging_table.par_account_price_adjustment_percent
           , staging_table.par_arm_margin_adjustment_percent
           , staging_table.par_loan_purpose_input_type
           , staging_table.par_property_usage_input_type
           , staging_table.par_doc_level_input_type
           , staging_table.par_property_category_input_type
           , staging_table.par_first_time_homebuyer_input_type
           , staging_table.par_self_employed_input_type
           , staging_table.par_amortization_input_type
           , staging_table.par_non_resident_alien_input_type
           , staging_table.par_hazardous_lava_zone_input_type
           , staging_table.par_property_rights_input_type
           , staging_table.par_property_acres_input_type
           , staging_table.par_arms_length_input_type
           , staging_table.par_state_input_type
           , staging_table.par_escrow_waiver_input_type
           , staging_table.par_subordinate_financing_input_type
           , staging_table.par_minimum_credit_score_input
           , staging_table.par_maximum_credit_score_input
           , staging_table.par_minimum_loan_amount_input
           , staging_table.par_maximum_loan_amount_input
           , staging_table.par_minimum_ltv_ratio_input
           , staging_table.par_maximum_ltv_ratio_input
           , staging_table.par_minimum_cltv_ratio_input
           , staging_table.par_maximum_cltv_ratio_input
           , staging_table.par_maximum_housing_ratio_input
           , staging_table.par_minimum_debt_ratio_input
           , staging_table.par_maximum_debt_ratio_input
           , staging_table.par_loan_purpose_purchase
           , staging_table.par_loan_purpose_change_in_rate_term
           , staging_table.par_loan_purpose_cash_out
           , staging_table.par_property_usage_primary_residence
           , staging_table.par_property_usage_second_home
           , staging_table.par_property_usage_investment
           , staging_table.par_doc_level_full
           , staging_table.par_doc_level_lite
           , staging_table.par_doc_level_limited
           , staging_table.par_doc_level_streamline_refinance
           , staging_table.par_property_category_detached
           , staging_table.par_property_category_attached
           , staging_table.par_property_category_condo_hotel
           , staging_table.par_property_category_duplex
           , staging_table.par_property_category_triplex
           , staging_table.par_property_category_fourplex
           , staging_table.par_property_category_commercial_residential
           , staging_table.par_property_category_condo_1_to_4_story
           , staging_table.par_property_category_condo_5_over_story
           , staging_table.par_property_category_manufactured_multi_wide
           , staging_table.par_property_category_manufactured_single_wide
           , staging_table.par_property_category_townhouse_rowhouse
           , staging_table.par_property_category_land_and_lots
           , staging_table.par_property_category_farm
           , staging_table.par_first_time_homebuyer
           , staging_table.par_not_first_time_homebuyer
           , staging_table.par_self_employed
           , staging_table.par_not_self_employed
           , staging_table.par_amortization_fully
           , staging_table.par_amortization_interest_only
           , staging_table.par_non_resident_alien
           , staging_table.par_not_non_resident_alien
           , staging_table.par_arms_length
           , staging_table.par_not_arms_length
           , staging_table.par_hazardous_lava_zone
           , staging_table.par_not_hazardous_lava_zone
           , staging_table.par_property_rights_fee_simple
           , staging_table.par_property_rights_leasehold
           , staging_table.par_under_10_acres
           , staging_table.par_not_under_10_acres
           , staging_table.par_escrow_waiver
           , staging_table.par_not_escrow_waiver
           , staging_table.par_subordinate_financing
           , staging_table.par_not_subordinate_financing
           , staging_table.par_minimum_credit_score
           , staging_table.par_maximum_credit_score
           , staging_table.par_minimum_loan_amount
           , staging_table.par_maximum_loan_amount
           , staging_table.par_minimum_ltv_ratio_percent
           , staging_table.par_maximum_ltv_ratio_percent
           , staging_table.par_minimum_cltv_ratio_percent
           , staging_table.par_maximum_cltv_ratio_percent
           , staging_table.par_maximum_housing_ratio_percent
           , staging_table.par_minimum_debt_ratio_percent
           , staging_table.par_maximum_debt_ratio_percent
           , staging_table.par_state_al
           , staging_table.par_state_ak
           , staging_table.par_state_az
           , staging_table.par_state_ar
           , staging_table.par_state_ca
           , staging_table.par_state_co
           , staging_table.par_state_ct
           , staging_table.par_state_de
           , staging_table.par_state_dc
           , staging_table.par_state_fl
           , staging_table.par_state_ga
           , staging_table.par_state_gu
           , staging_table.par_state_hi
           , staging_table.par_state_id
           , staging_table.par_state_il
           , staging_table.par_state_in
           , staging_table.par_state_ia
           , staging_table.par_state_ks
           , staging_table.par_state_ky
           , staging_table.par_state_la
           , staging_table.par_state_me
           , staging_table.par_state_md
           , staging_table.par_state_ma
           , staging_table.par_state_mi
           , staging_table.par_state_mn
           , staging_table.par_state_ms
           , staging_table.par_state_mo
           , staging_table.par_state_mt
           , staging_table.par_state_ne
           , staging_table.par_state_nv
           , staging_table.par_state_nh
           , staging_table.par_state_nj
           , staging_table.par_state_nm
           , staging_table.par_state_ny
           , staging_table.par_state_nc
           , staging_table.par_state_nd
           , staging_table.par_state_oh
           , staging_table.par_state_ok
           , staging_table.par_state_or
           , staging_table.par_state_pa
           , staging_table.par_state_pr
           , staging_table.par_state_ri
           , staging_table.par_state_sc
           , staging_table.par_state_sd
           , staging_table.par_state_tn
           , staging_table.par_state_tx
           , staging_table.par_state_ut
           , staging_table.par_state_vt
           , staging_table.par_state_va
           , staging_table.par_state_vi
           , staging_table.par_state_wa
           , staging_table.par_state_wv
           , staging_table.par_state_wi
           , staging_table.par_state_wy
           , FALSE AS data_source_deleted_flag
           , NOW( ) AS data_source_updated_datetime
      FROM staging_octane.product_add_on_rule staging_table
      LEFT JOIN history_octane.product_add_on_rule history_table
                ON staging_table.par_pid = history_table.par_pid
                    AND staging_table.par_version = history_table.par_version
      WHERE history_table.par_pid IS NULL
      UNION ALL
      SELECT history_table.par_pid
           , history_table.par_version + 1
           , history_table.par_product_add_on_pid
           , history_table.par_summary
           , history_table.par_note
           , history_table.par_rate_adjustment_percent
           , history_table.par_investor_price_adjustment_percent
           , history_table.par_account_price_adjustment_percent
           , history_table.par_arm_margin_adjustment_percent
           , history_table.par_loan_purpose_input_type
           , history_table.par_property_usage_input_type
           , history_table.par_doc_level_input_type
           , history_table.par_property_category_input_type
           , history_table.par_first_time_homebuyer_input_type
           , history_table.par_self_employed_input_type
           , history_table.par_amortization_input_type
           , history_table.par_non_resident_alien_input_type
           , history_table.par_hazardous_lava_zone_input_type
           , history_table.par_property_rights_input_type
           , history_table.par_property_acres_input_type
           , history_table.par_arms_length_input_type
           , history_table.par_state_input_type
           , history_table.par_escrow_waiver_input_type
           , history_table.par_subordinate_financing_input_type
           , history_table.par_minimum_credit_score_input
           , history_table.par_maximum_credit_score_input
           , history_table.par_minimum_loan_amount_input
           , history_table.par_maximum_loan_amount_input
           , history_table.par_minimum_ltv_ratio_input
           , history_table.par_maximum_ltv_ratio_input
           , history_table.par_minimum_cltv_ratio_input
           , history_table.par_maximum_cltv_ratio_input
           , history_table.par_maximum_housing_ratio_input
           , history_table.par_minimum_debt_ratio_input
           , history_table.par_maximum_debt_ratio_input
           , history_table.par_loan_purpose_purchase
           , history_table.par_loan_purpose_change_in_rate_term
           , history_table.par_loan_purpose_cash_out
           , history_table.par_property_usage_primary_residence
           , history_table.par_property_usage_second_home
           , history_table.par_property_usage_investment
           , history_table.par_doc_level_full
           , history_table.par_doc_level_lite
           , history_table.par_doc_level_limited
           , history_table.par_doc_level_streamline_refinance
           , history_table.par_property_category_detached
           , history_table.par_property_category_attached
           , history_table.par_property_category_condo_hotel
           , history_table.par_property_category_duplex
           , history_table.par_property_category_triplex
           , history_table.par_property_category_fourplex
           , history_table.par_property_category_commercial_residential
           , history_table.par_property_category_condo_1_to_4_story
           , history_table.par_property_category_condo_5_over_story
           , history_table.par_property_category_manufactured_multi_wide
           , history_table.par_property_category_manufactured_single_wide
           , history_table.par_property_category_townhouse_rowhouse
           , history_table.par_property_category_land_and_lots
           , history_table.par_property_category_farm
           , history_table.par_first_time_homebuyer
           , history_table.par_not_first_time_homebuyer
           , history_table.par_self_employed
           , history_table.par_not_self_employed
           , history_table.par_amortization_fully
           , history_table.par_amortization_interest_only
           , history_table.par_non_resident_alien
           , history_table.par_not_non_resident_alien
           , history_table.par_arms_length
           , history_table.par_not_arms_length
           , history_table.par_hazardous_lava_zone
           , history_table.par_not_hazardous_lava_zone
           , history_table.par_property_rights_fee_simple
           , history_table.par_property_rights_leasehold
           , history_table.par_under_10_acres
           , history_table.par_not_under_10_acres
           , history_table.par_escrow_waiver
           , history_table.par_not_escrow_waiver
           , history_table.par_subordinate_financing
           , history_table.par_not_subordinate_financing
           , history_table.par_minimum_credit_score
           , history_table.par_maximum_credit_score
           , history_table.par_minimum_loan_amount
           , history_table.par_maximum_loan_amount
           , history_table.par_minimum_ltv_ratio_percent
           , history_table.par_maximum_ltv_ratio_percent
           , history_table.par_minimum_cltv_ratio_percent
           , history_table.par_maximum_cltv_ratio_percent
           , history_table.par_maximum_housing_ratio_percent
           , history_table.par_minimum_debt_ratio_percent
           , history_table.par_maximum_debt_ratio_percent
           , history_table.par_state_al
           , history_table.par_state_ak
           , history_table.par_state_az
           , history_table.par_state_ar
           , history_table.par_state_ca
           , history_table.par_state_co
           , history_table.par_state_ct
           , history_table.par_state_de
           , history_table.par_state_dc
           , history_table.par_state_fl
           , history_table.par_state_ga
           , history_table.par_state_gu
           , history_table.par_state_hi
           , history_table.par_state_id
           , history_table.par_state_il
           , history_table.par_state_in
           , history_table.par_state_ia
           , history_table.par_state_ks
           , history_table.par_state_ky
           , history_table.par_state_la
           , history_table.par_state_me
           , history_table.par_state_md
           , history_table.par_state_ma
           , history_table.par_state_mi
           , history_table.par_state_mn
           , history_table.par_state_ms
           , history_table.par_state_mo
           , history_table.par_state_mt
           , history_table.par_state_ne
           , history_table.par_state_nv
           , history_table.par_state_nh
           , history_table.par_state_nj
           , history_table.par_state_nm
           , history_table.par_state_ny
           , history_table.par_state_nc
           , history_table.par_state_nd
           , history_table.par_state_oh
           , history_table.par_state_ok
           , history_table.par_state_or
           , history_table.par_state_pa
           , history_table.par_state_pr
           , history_table.par_state_ri
           , history_table.par_state_sc
           , history_table.par_state_sd
           , history_table.par_state_tn
           , history_table.par_state_tx
           , history_table.par_state_ut
           , history_table.par_state_vt
           , history_table.par_state_va
           , history_table.par_state_vi
           , history_table.par_state_wa
           , history_table.par_state_wv
           , history_table.par_state_wi
           , history_table.par_state_wy
           , TRUE AS data_source_deleted_flag
           , NOW( ) AS data_source_updated_datetime
      FROM history_octane.product_add_on_rule history_table
      LEFT JOIN staging_octane.product_add_on_rule staging_table
                ON staging_table.par_pid = history_table.par_pid
      WHERE staging_table.par_pid IS NULL
        AND NOT EXISTS(
          SELECT 1
          FROM history_octane.product_add_on_rule deleted_records
          WHERE deleted_records.par_pid = history_table.par_pid
            AND deleted_records.data_source_deleted_flag = TRUE
          );
