name: product_terms
primary_source_table: staging.staging_octane.product_terms
primary_key:
- pt_pid
- pt_version
foreign_keys:
  fk_product_terms_1:
    columns:
    - pt_product_pid
    references:
      columns:
      - p_pid
      schema: history_octane
      table: product
  fkt_pt_arm_index_type:
    columns:
    - pt_arm_index_type
    references:
      columns:
      - code
      schema: history_octane
      table: arm_index_type
  fkt_pt_arm_payment_adjustment_calculation_type:
    columns:
    - pt_arm_payment_adjustment_calculation_type
    references:
      columns:
      - code
      schema: history_octane
      table: payment_adjustment_calculation_type
  fkt_pt_buydown_base_date_type:
    columns:
    - pt_buydown_base_date_type
    references:
      columns:
      - code
      schema: history_octane
      table: buydown_base_date_type
  fkt_pt_buydown_subsidy_calculation_type:
    columns:
    - pt_buydown_subsidy_calculation_type
    references:
      columns:
      - code
      schema: history_octane
      table: buydown_subsidy_calculation_type
  fkt_pt_community_lending_type:
    columns:
    - pt_community_lending_type
    references:
      columns:
      - code
      schema: history_octane
      table: community_lending_type
  fkt_pt_days_per_year_type:
    columns:
    - pt_days_per_year_type
    references:
      columns:
      - code
      schema: history_octane
      table: days_per_year_type
  fkt_pt_decision_credit_score_calc_type:
    columns:
    - pt_decision_credit_score_calc_type
    references:
      columns:
      - code
      schema: history_octane
      table: decision_credit_score_calc_type
  fkt_pt_fha_rehab_program_type:
    columns:
    - pt_fha_rehab_program_type
    references:
      columns:
      - code
      schema: history_octane
      table: fha_rehab_program_type
  fkt_pt_fha_special_program_type:
    columns:
    - pt_fha_special_program_type
    references:
      columns:
      - code
      schema: history_octane
      table: fha_special_program_type
  fkt_pt_fnm_arm_plan_type:
    columns:
    - pt_fnm_arm_plan_type
    references:
      columns:
      - code
      schema: history_octane
      table: fnm_arm_plan_type
  fkt_pt_fnm_community_lending_product_type:
    columns:
    - pt_fnm_community_lending_product_type
    references:
      columns:
      - code
      schema: history_octane
      table: fnm_community_lending_product_type
  fkt_pt_fre_community_program_type:
    columns:
    - pt_fre_community_program_type
    references:
      columns:
      - code
      schema: history_octane
      table: fre_community_program_type
  fkt_pt_heloc_cancel_fee_applicable_type:
    columns:
    - pt_heloc_cancel_fee_applicable_type
    references:
      columns:
      - code
      schema: history_octane
      table: heloc_cancel_fee_applicable_type
  fkt_pt_high_balance_temp:
    columns:
    - pt_high_balance
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_na_unknown_type
  fkt_pt_ipc_calc_type:
    columns:
    - pt_ipc_calc_type
    references:
      columns:
      - code
      schema: history_octane
      table: ipc_calc_type
  fkt_pt_ipc_comparison_operator_type1:
    columns:
    - pt_ipc_comparison_operator_type1
    references:
      columns:
      - code
      schema: history_octane
      table: ipc_comparison_operator_type
  fkt_pt_ipc_comparison_operator_type2:
    columns:
    - pt_ipc_comparison_operator_type2
    references:
      columns:
      - code
      schema: history_octane
      table: ipc_comparison_operator_type
  fkt_pt_ipc_comparison_operator_type3:
    columns:
    - pt_ipc_comparison_operator_type3
    references:
      columns:
      - code
      schema: history_octane
      table: ipc_comparison_operator_type
  fkt_pt_ipc_comparison_operator_type4:
    columns:
    - pt_ipc_comparison_operator_type4
    references:
      columns:
      - code
      schema: history_octane
      table: ipc_comparison_operator_type
  fkt_pt_ipc_property_usage_type1:
    columns:
    - pt_ipc_property_usage_type1
    references:
      columns:
      - code
      schema: history_octane
      table: ipc_property_usage_type
  fkt_pt_ipc_property_usage_type2:
    columns:
    - pt_ipc_property_usage_type2
    references:
      columns:
      - code
      schema: history_octane
      table: ipc_property_usage_type
  fkt_pt_ipc_property_usage_type3:
    columns:
    - pt_ipc_property_usage_type3
    references:
      columns:
      - code
      schema: history_octane
      table: ipc_property_usage_type
  fkt_pt_ipc_property_usage_type4:
    columns:
    - pt_ipc_property_usage_type4
    references:
      columns:
      - code
      schema: history_octane
      table: ipc_property_usage_type
  fkt_pt_lien_priority_type:
    columns:
    - pt_lien_priority_type
    references:
      columns:
      - code
      schema: history_octane
      table: lien_priority_type
  fkt_pt_loan_amortization_type:
    columns:
    - pt_loan_amortization_type
    references:
      columns:
      - code
      schema: history_octane
      table: loan_amortization_type
  fkt_pt_mortgage_type:
    columns:
    - pt_mortgage_type
    references:
      columns:
      - code
      schema: history_octane
      table: mortgage_type
  fkt_pt_negative_amortization_type:
    columns:
    - pt_negative_amortization_type
    references:
      columns:
      - code
      schema: history_octane
      table: negative_amortization_type
  fkt_pt_partial_payment_policy_type:
    columns:
    - pt_partial_payment_policy_type
    references:
      columns:
      - code
      schema: history_octane
      table: partial_payment_policy_type
  fkt_pt_payment_frequency_type:
    columns:
    - pt_payment_frequency_type
    references:
      columns:
      - code
      schema: history_octane
      table: payment_frequency_type
  fkt_pt_payment_structure_type:
    columns:
    - pt_payment_structure_type
    references:
      columns:
      - code
      schema: history_octane
      table: payment_structure_type
  fkt_pt_prepaid_interest_rate_type:
    columns:
    - pt_prepaid_interest_rate_type
    references:
      columns:
      - code
      schema: history_octane
      table: prepaid_interest_rate_type
  fkt_pt_prepay_penalty_type:
    columns:
    - pt_prepay_penalty_type
    references:
      columns:
      - code
      schema: history_octane
      table: prepay_penalty_type
  fkt_pt_product_appraisal_requirement_type:
    columns:
    - pt_product_appraisal_requirement_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_appraisal_requirement_type
  fkt_pt_product_special_program_type:
    columns:
    - pt_product_special_program_type
    references:
      columns:
      - code
      schema: history_octane
      table: product_special_program_type
  fkt_pt_qualifying_monthly_payment_type:
    columns:
    - pt_qualifying_monthly_payment_type
    references:
      columns:
      - code
      schema: history_octane
      table: qualifying_monthly_payment_type
  fkt_pt_qualifying_rate_type:
    columns:
    - pt_qualifying_rate_type
    references:
      columns:
      - code
      schema: history_octane
      table: qualifying_rate_type
  fkt_pt_section_of_act_coarse_type:
    columns:
    - pt_section_of_act_coarse_type
    references:
      columns:
      - code
      schema: history_octane
      table: section_of_act_coarse_type
  fkt_pt_servicing_transfer_type:
    columns:
    - pt_servicing_transfer_type
    references:
      columns:
      - code
      schema: history_octane
      table: servicing_transfer_type
  fkt_pt_texas_veterans_land_board:
    columns:
    - pt_texas_veterans_land_board
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_pt_third_party_community_second_program_eligibility_type:
    columns:
    - pt_third_party_community_second_program_eligibility_type
    references:
      columns:
      - code
      schema: history_octane
      table: third_party_community_second_program_eligibility_type
columns:
  data_source_deleted_flag:
    data_type: BOOLEAN
  data_source_updated_datetime:
    data_type: TIMESTAMPTZ
  etl_batch_id:
    data_type: TEXT
  pt_allow_loan_amount_cents:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_allow_loan_amount_cents
  pt_always_current_market_price:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_always_current_market_price
  pt_amortization_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_amortization_term_months
  pt_arm_convertible:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_arm_convertible
  pt_arm_convertible_from_month:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_arm_convertible_from_month
  pt_arm_convertible_through_month:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_arm_convertible_through_month
  pt_arm_floor_rate_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_arm_floor_rate_percent
  pt_arm_index_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_arm_index_type
  pt_arm_lookback_period_days:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_arm_lookback_period_days
  pt_arm_payment_adjustment_calculation_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_arm_payment_adjustment_calculation_type
  pt_assumable:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_assumable
  pt_buydown_base_date_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_buydown_base_date_type
  pt_buydown_subsidy_calculation_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_buydown_subsidy_calculation_type
  pt_community_lending_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_community_lending_type
  pt_conditions_to_assumability:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_conditions_to_assumability
  pt_credit_qualifying:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_credit_qualifying
  pt_days_per_year_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_days_per_year_type
  pt_decision_credit_score_calc_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_decision_credit_score_calc_type
  pt_deed_page_count:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_deed_page_count
  pt_deferred_payment_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_deferred_payment_months
  pt_demand_feature:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_demand_feature
  pt_dsi_plan_code:
    data_type: VARCHAR(128)
  pt_du_risk_assessment_accepted:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_du_risk_assessment_accepted
  pt_due_in_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_due_in_term_months
  pt_escrow_cushion_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_escrow_cushion_months
  pt_escrow_waiver_allowed:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_escrow_waiver_allowed
  pt_external_fha_underwrite_accepted:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_external_fha_underwrite_accepted
  pt_external_investor_underwrite_accepted:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_external_investor_underwrite_accepted
  pt_external_usda_underwrite_accepted:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_external_usda_underwrite_accepted
  pt_external_va_underwrite_accepted:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_external_va_underwrite_accepted
  pt_family_advantage:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_family_advantage
  pt_fha_rehab_program_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fha_rehab_program_type
  pt_fha_special_program_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fha_special_program_type
  pt_fnm_arm_plan_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fnm_arm_plan_type
  pt_fnm_community_lending_product_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fnm_community_lending_product_type
  pt_fre_community_program_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fre_community_program_type
  pt_from_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.pt_from_date
  pt_gpm_adjustment_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_gpm_adjustment_percent
  pt_gpm_adjustment_years:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_gpm_adjustment_years
  pt_heloc_cancel_fee_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.pt_heloc_cancel_fee_amount
  pt_heloc_cancel_fee_applicable_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_heloc_cancel_fee_applicable_type
  pt_heloc_cancel_fee_period_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_heloc_cancel_fee_period_months
  pt_heloc_draw_period_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_heloc_draw_period_months
  pt_heloc_maximum_initial_draw:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_heloc_maximum_initial_draw
  pt_heloc_maximum_initial_draw_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.pt_heloc_maximum_initial_draw_amount
  pt_heloc_minimum_draw:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_heloc_minimum_draw
  pt_heloc_minimum_draw_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.pt_heloc_minimum_draw_amount
  pt_heloc_repayment_period_duration_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_heloc_repayment_period_duration_months
  pt_high_balance:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_high_balance
  pt_initial_payment_adjustment_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_initial_payment_adjustment_term_months
  pt_initial_rate_adjustment_cap_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_initial_rate_adjustment_cap_percent
  pt_initial_rate_adjustment_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_initial_rate_adjustment_term_months
  pt_internal_underwrite_accepted:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_internal_underwrite_accepted
  pt_ipc_calc_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_calc_type
  pt_ipc_cltv_ratio_percent1:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_ipc_cltv_ratio_percent1
  pt_ipc_cltv_ratio_percent2:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_ipc_cltv_ratio_percent2
  pt_ipc_cltv_ratio_percent3:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_ipc_cltv_ratio_percent3
  pt_ipc_cltv_ratio_percent4:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_ipc_cltv_ratio_percent4
  pt_ipc_comparison_operator_type1:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_comparison_operator_type1
  pt_ipc_comparison_operator_type2:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_comparison_operator_type2
  pt_ipc_comparison_operator_type3:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_comparison_operator_type3
  pt_ipc_comparison_operator_type4:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_comparison_operator_type4
  pt_ipc_limit_percent1:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_ipc_limit_percent1
  pt_ipc_limit_percent2:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_ipc_limit_percent2
  pt_ipc_limit_percent3:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_ipc_limit_percent3
  pt_ipc_limit_percent4:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_ipc_limit_percent4
  pt_ipc_property_usage_type1:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_property_usage_type1
  pt_ipc_property_usage_type2:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_property_usage_type2
  pt_ipc_property_usage_type3:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_property_usage_type3
  pt_ipc_property_usage_type4:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_property_usage_type4
  pt_lender_hazard_insurance_available:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_lender_hazard_insurance_available
  pt_lender_hazard_insurance_premium_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.pt_lender_hazard_insurance_premium_amount
  pt_lender_hazard_insurance_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_lender_hazard_insurance_term_months
  pt_lien_priority_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_lien_priority_type
  pt_loan_amortization_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_loan_amortization_type
  pt_loan_requires_hazard_insurance:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_loan_requires_hazard_insurance
  pt_lp_risk_assessment_accepted:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_lp_risk_assessment_accepted
  pt_manual_risk_assessment_accepted:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_manual_risk_assessment_accepted
  pt_maximum_number_of_construction_draws:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_maximum_number_of_construction_draws
  pt_minimum_payment_rate_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_minimum_payment_rate_percent
  pt_minimum_rate_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_minimum_rate_term_months
  pt_mortgage_credit_certificate_eligible:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_mortgage_credit_certificate_eligible
  pt_mortgage_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_mortgage_type
  pt_negative_amortization_limit_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_negative_amortization_limit_percent
  pt_negative_amortization_recast_period_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_negative_amortization_recast_period_months
  pt_negative_amortization_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_negative_amortization_type
  pt_new_york:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_new_york
  pt_no_mi_product:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_no_mi_product
  pt_non_conforming:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_non_conforming
  pt_partial_payment_policy_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_partial_payment_policy_type
  pt_payment_adjustment_lifetime_cap_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_payment_adjustment_lifetime_cap_percent
  pt_payment_adjustment_periodic_cap:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_payment_adjustment_periodic_cap
  pt_payment_frequency_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_payment_frequency_type
  pt_payment_structure_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_payment_structure_type
  pt_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.pt_pid
  pt_prepaid_interest_rate_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_prepaid_interest_rate_type
  pt_prepay_penalty_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_prepay_penalty_type
  pt_prepayment_finance_charge_refund:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_prepayment_finance_charge_refund
  pt_product_appraisal_requirement_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_product_appraisal_requirement_type
  pt_product_category:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_product_category
  pt_product_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.pt_product_pid
  pt_product_special_program_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_product_special_program_type
  pt_qualifying_monthly_payment_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_qualifying_monthly_payment_type
  pt_qualifying_rate_input_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_qualifying_rate_input_percent
  pt_qualifying_rate_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_qualifying_rate_type
  pt_rate_adjustment_lifetime_cap_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_rate_adjustment_lifetime_cap_percent
  pt_rate_protect:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_rate_protect
  pt_section_of_act_coarse_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_section_of_act_coarse_type
  pt_security_instrument_page_count:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_security_instrument_page_count
  pt_servicing_transfer_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_servicing_transfer_type
  pt_subsequent_payment_adjustment_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_subsequent_payment_adjustment_term_months
  pt_subsequent_rate_adjustment_cap_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.pt_subsequent_rate_adjustment_cap_percent
  pt_subsequent_rate_adjustment_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_subsequent_rate_adjustment_term_months
  pt_texas_veterans_land_board:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_texas_veterans_land_board
  pt_third_party_community_second_program_eligibility_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_third_party_community_second_program_eligibility_type
  pt_third_party_grant_eligible:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_third_party_grant_eligible
  pt_version:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_version
  pt_zero_note_rate:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_zero_note_rate
step_functions:
  SP-100285:
    etls:
      ETL-100285:
        input_type: table
        output_type: insert
        output_table: staging.history_octane.product_terms
        json_output_field: pt_pid
        truncate_table: false
        container_memory: 4096
        next_step_functions:
        - SP-200018
        input_sql: |-
          --finding records to insert into history_octane.product_terms
          SELECT staging_table.pt_pid
               , staging_table.pt_version
               , staging_table.pt_amortization_term_months
               , staging_table.pt_arm_index_type
               , staging_table.pt_arm_payment_adjustment_calculation_type
               , staging_table.pt_assumable
               , staging_table.pt_product_category
               , staging_table.pt_conditions_to_assumability
               , staging_table.pt_demand_feature
               , staging_table.pt_due_in_term_months
               , staging_table.pt_escrow_cushion_months
               , staging_table.pt_from_date
               , staging_table.pt_initial_payment_adjustment_term_months
               , staging_table.pt_initial_rate_adjustment_cap_percent
               , staging_table.pt_initial_rate_adjustment_term_months
               , staging_table.pt_lien_priority_type
               , staging_table.pt_loan_amortization_type
               , staging_table.pt_minimum_payment_rate_percent
               , staging_table.pt_minimum_rate_term_months
               , staging_table.pt_mortgage_type
               , staging_table.pt_negative_amortization_type
               , staging_table.pt_negative_amortization_limit_percent
               , staging_table.pt_negative_amortization_recast_period_months
               , staging_table.pt_payment_adjustment_lifetime_cap_percent
               , staging_table.pt_payment_adjustment_periodic_cap
               , staging_table.pt_payment_frequency_type
               , staging_table.pt_prepayment_finance_charge_refund
               , staging_table.pt_product_pid
               , staging_table.pt_rate_adjustment_lifetime_cap_percent
               , staging_table.pt_subsequent_payment_adjustment_term_months
               , staging_table.pt_subsequent_rate_adjustment_cap_percent
               , staging_table.pt_subsequent_rate_adjustment_term_months
               , staging_table.pt_prepay_penalty_type
               , staging_table.pt_lender_hazard_insurance_available
               , staging_table.pt_lender_hazard_insurance_premium_amount
               , staging_table.pt_lender_hazard_insurance_term_months
               , staging_table.pt_loan_requires_hazard_insurance
               , staging_table.pt_arm_convertible
               , staging_table.pt_arm_convertible_from_month
               , staging_table.pt_arm_convertible_through_month
               , staging_table.pt_arm_floor_rate_percent
               , staging_table.pt_arm_lookback_period_days
               , staging_table.pt_escrow_waiver_allowed
               , staging_table.pt_days_per_year_type
               , staging_table.pt_lp_risk_assessment_accepted
               , staging_table.pt_du_risk_assessment_accepted
               , staging_table.pt_manual_risk_assessment_accepted
               , staging_table.pt_internal_underwrite_accepted
               , staging_table.pt_external_fha_underwrite_accepted
               , staging_table.pt_external_va_underwrite_accepted
               , staging_table.pt_external_usda_underwrite_accepted
               , staging_table.pt_external_investor_underwrite_accepted
               , staging_table.pt_heloc_cancel_fee_applicable_type
               , staging_table.pt_heloc_cancel_fee_period_months
               , staging_table.pt_heloc_cancel_fee_amount
               , staging_table.pt_heloc_draw_period_months
               , staging_table.pt_heloc_repayment_period_duration_months
               , staging_table.pt_heloc_maximum_initial_draw
               , staging_table.pt_heloc_maximum_initial_draw_amount
               , staging_table.pt_heloc_minimum_draw
               , staging_table.pt_heloc_minimum_draw_amount
               , staging_table.pt_gpm_adjustment_years
               , staging_table.pt_gpm_adjustment_percent
               , staging_table.pt_qualifying_monthly_payment_type
               , staging_table.pt_qualifying_rate_type
               , staging_table.pt_qualifying_rate_input_percent
               , staging_table.pt_ipc_calc_type
               , staging_table.pt_ipc_limit_percent1
               , staging_table.pt_ipc_property_usage_type1
               , staging_table.pt_ipc_comparison_operator_type1
               , staging_table.pt_ipc_cltv_ratio_percent1
               , staging_table.pt_ipc_limit_percent2
               , staging_table.pt_ipc_property_usage_type2
               , staging_table.pt_ipc_comparison_operator_type2
               , staging_table.pt_ipc_cltv_ratio_percent2
               , staging_table.pt_ipc_limit_percent3
               , staging_table.pt_ipc_property_usage_type3
               , staging_table.pt_ipc_comparison_operator_type3
               , staging_table.pt_ipc_cltv_ratio_percent3
               , staging_table.pt_ipc_limit_percent4
               , staging_table.pt_ipc_property_usage_type4
               , staging_table.pt_ipc_comparison_operator_type4
               , staging_table.pt_ipc_cltv_ratio_percent4
               , staging_table.pt_buydown_base_date_type
               , staging_table.pt_buydown_subsidy_calculation_type
               , staging_table.pt_prepaid_interest_rate_type
               , staging_table.pt_fnm_arm_plan_type
               , staging_table.pt_credit_qualifying
               , staging_table.pt_product_special_program_type
               , staging_table.pt_section_of_act_coarse_type
               , staging_table.pt_fha_rehab_program_type
               , staging_table.pt_fha_special_program_type
               , staging_table.pt_third_party_grant_eligible
               , staging_table.pt_servicing_transfer_type
               , staging_table.pt_no_mi_product
               , staging_table.pt_mortgage_credit_certificate_eligible
               , staging_table.pt_fre_community_program_type
               , staging_table.pt_fnm_community_lending_product_type
               , staging_table.pt_zero_note_rate
               , staging_table.pt_third_party_community_second_program_eligibility_type
               , staging_table.pt_texas_veterans_land_board
               , staging_table.pt_security_instrument_page_count
               , staging_table.pt_deed_page_count
               , staging_table.pt_partial_payment_policy_type
               , staging_table.pt_payment_structure_type
               , staging_table.pt_deferred_payment_months
               , staging_table.pt_always_current_market_price
               , staging_table.pt_rate_protect
               , staging_table.pt_non_conforming
               , staging_table.pt_allow_loan_amount_cents
               , staging_table.pt_product_appraisal_requirement_type
               , staging_table.pt_family_advantage
               , staging_table.pt_community_lending_type
               , staging_table.pt_high_balance
               , staging_table.pt_decision_credit_score_calc_type
               , staging_table.pt_new_york
               , staging_table.pt_maximum_number_of_construction_draws
               , FALSE AS data_source_deleted_flag
               , NOW( ) AS data_source_updated_datetime
          FROM staging_octane.product_terms staging_table
          LEFT JOIN history_octane.product_terms history_table
                    ON staging_table.pt_pid = history_table.pt_pid
                        AND staging_table.pt_version = history_table.pt_version
          WHERE history_table.pt_pid IS NULL
          UNION ALL
          SELECT history_table.pt_pid
               , history_table.pt_version + 1
               , history_table.pt_amortization_term_months
               , history_table.pt_arm_index_type
               , history_table.pt_arm_payment_adjustment_calculation_type
               , history_table.pt_assumable
               , history_table.pt_product_category
               , history_table.pt_conditions_to_assumability
               , history_table.pt_demand_feature
               , history_table.pt_due_in_term_months
               , history_table.pt_escrow_cushion_months
               , history_table.pt_from_date
               , history_table.pt_initial_payment_adjustment_term_months
               , history_table.pt_initial_rate_adjustment_cap_percent
               , history_table.pt_initial_rate_adjustment_term_months
               , history_table.pt_lien_priority_type
               , history_table.pt_loan_amortization_type
               , history_table.pt_minimum_payment_rate_percent
               , history_table.pt_minimum_rate_term_months
               , history_table.pt_mortgage_type
               , history_table.pt_negative_amortization_type
               , history_table.pt_negative_amortization_limit_percent
               , history_table.pt_negative_amortization_recast_period_months
               , history_table.pt_payment_adjustment_lifetime_cap_percent
               , history_table.pt_payment_adjustment_periodic_cap
               , history_table.pt_payment_frequency_type
               , history_table.pt_prepayment_finance_charge_refund
               , history_table.pt_product_pid
               , history_table.pt_rate_adjustment_lifetime_cap_percent
               , history_table.pt_subsequent_payment_adjustment_term_months
               , history_table.pt_subsequent_rate_adjustment_cap_percent
               , history_table.pt_subsequent_rate_adjustment_term_months
               , history_table.pt_prepay_penalty_type
               , history_table.pt_lender_hazard_insurance_available
               , history_table.pt_lender_hazard_insurance_premium_amount
               , history_table.pt_lender_hazard_insurance_term_months
               , history_table.pt_loan_requires_hazard_insurance
               , history_table.pt_arm_convertible
               , history_table.pt_arm_convertible_from_month
               , history_table.pt_arm_convertible_through_month
               , history_table.pt_arm_floor_rate_percent
               , history_table.pt_arm_lookback_period_days
               , history_table.pt_escrow_waiver_allowed
               , history_table.pt_days_per_year_type
               , history_table.pt_lp_risk_assessment_accepted
               , history_table.pt_du_risk_assessment_accepted
               , history_table.pt_manual_risk_assessment_accepted
               , history_table.pt_internal_underwrite_accepted
               , history_table.pt_external_fha_underwrite_accepted
               , history_table.pt_external_va_underwrite_accepted
               , history_table.pt_external_usda_underwrite_accepted
               , history_table.pt_external_investor_underwrite_accepted
               , history_table.pt_heloc_cancel_fee_applicable_type
               , history_table.pt_heloc_cancel_fee_period_months
               , history_table.pt_heloc_cancel_fee_amount
               , history_table.pt_heloc_draw_period_months
               , history_table.pt_heloc_repayment_period_duration_months
               , history_table.pt_heloc_maximum_initial_draw
               , history_table.pt_heloc_maximum_initial_draw_amount
               , history_table.pt_heloc_minimum_draw
               , history_table.pt_heloc_minimum_draw_amount
               , history_table.pt_gpm_adjustment_years
               , history_table.pt_gpm_adjustment_percent
               , history_table.pt_qualifying_monthly_payment_type
               , history_table.pt_qualifying_rate_type
               , history_table.pt_qualifying_rate_input_percent
               , history_table.pt_ipc_calc_type
               , history_table.pt_ipc_limit_percent1
               , history_table.pt_ipc_property_usage_type1
               , history_table.pt_ipc_comparison_operator_type1
               , history_table.pt_ipc_cltv_ratio_percent1
               , history_table.pt_ipc_limit_percent2
               , history_table.pt_ipc_property_usage_type2
               , history_table.pt_ipc_comparison_operator_type2
               , history_table.pt_ipc_cltv_ratio_percent2
               , history_table.pt_ipc_limit_percent3
               , history_table.pt_ipc_property_usage_type3
               , history_table.pt_ipc_comparison_operator_type3
               , history_table.pt_ipc_cltv_ratio_percent3
               , history_table.pt_ipc_limit_percent4
               , history_table.pt_ipc_property_usage_type4
               , history_table.pt_ipc_comparison_operator_type4
               , history_table.pt_ipc_cltv_ratio_percent4
               , history_table.pt_buydown_base_date_type
               , history_table.pt_buydown_subsidy_calculation_type
               , history_table.pt_prepaid_interest_rate_type
               , history_table.pt_fnm_arm_plan_type
               , history_table.pt_credit_qualifying
               , history_table.pt_product_special_program_type
               , history_table.pt_section_of_act_coarse_type
               , history_table.pt_fha_rehab_program_type
               , history_table.pt_fha_special_program_type
               , history_table.pt_third_party_grant_eligible
               , history_table.pt_servicing_transfer_type
               , history_table.pt_no_mi_product
               , history_table.pt_mortgage_credit_certificate_eligible
               , history_table.pt_fre_community_program_type
               , history_table.pt_fnm_community_lending_product_type
               , history_table.pt_zero_note_rate
               , history_table.pt_third_party_community_second_program_eligibility_type
               , history_table.pt_texas_veterans_land_board
               , history_table.pt_security_instrument_page_count
               , history_table.pt_deed_page_count
               , history_table.pt_partial_payment_policy_type
               , history_table.pt_payment_structure_type
               , history_table.pt_deferred_payment_months
               , history_table.pt_always_current_market_price
               , history_table.pt_rate_protect
               , history_table.pt_non_conforming
               , history_table.pt_allow_loan_amount_cents
               , history_table.pt_product_appraisal_requirement_type
               , history_table.pt_family_advantage
               , history_table.pt_community_lending_type
               , history_table.pt_high_balance
               , history_table.pt_decision_credit_score_calc_type
               , history_table.pt_new_york
               , history_table.pt_maximum_number_of_construction_draws
               , TRUE AS data_source_deleted_flag
               , NOW( ) AS data_source_updated_datetime
          FROM history_octane.product_terms history_table
          LEFT JOIN staging_octane.product_terms staging_table
                    ON staging_table.pt_pid = history_table.pt_pid
          WHERE staging_table.pt_pid IS NULL
            AND NOT EXISTS(
              SELECT 1
              FROM history_octane.product_terms deleted_records
              WHERE deleted_records.pt_pid = history_table.pt_pid
                AND deleted_records.data_source_deleted_flag = TRUE
              );
