name: proposal
primary_source_table: staging.staging_octane.proposal
primary_key:
- prp_pid
- prp_version
foreign_keys:
  fk_proposal_1:
    columns:
    - prp_deal_pid
    references:
      columns:
      - d_pid
      schema: history_octane
      table: deal
  fk_proposal_2:
    columns:
    - prp_decision_lp_request_pid
    references:
      columns:
      - lpr_pid
      schema: history_octane
      table: lp_request
  fk_proposal_3:
    columns:
    - prp_decision_du_request_pid
    references:
      columns:
      - dur_pid
      schema: history_octane
      table: du_request
  fk_proposal_5:
    columns:
    - prp_decision_credit_score_borrower_pid
    references:
      columns:
      - b_pid
      schema: history_octane
      table: borrower
  fk_proposal_7:
    columns:
    - prp_trustee_pid
    references:
      columns:
      - tru_pid
      schema: history_octane
      table: trustee
  fk_proposal_8:
    columns:
    - prp_decision_veteran_borrower_pid
    references:
      columns:
      - b_pid
      schema: history_octane
      table: borrower
  fkt_prp_any_vesting_changes:
    columns:
    - prp_any_vesting_changes
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_arms_length:
    columns:
    - prp_arms_length
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_cema:
    columns:
    - prp_cema
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_na_unknown_type
  fkt_prp_construction_lot_ownership_status_type:
    columns:
    - prp_construction_lot_ownership_status_type
    references:
      columns:
      - code
      schema: history_octane
      table: construction_lot_ownership_status_type
  fkt_prp_disaster_declaration_check_date_type:
    columns:
    - prp_disaster_declaration_check_date_type
    references:
      columns:
      - code
      schema: history_octane
      table: disaster_declaration_check_date_type
  fkt_prp_disclosure_action_type:
    columns:
    - prp_disclosure_action_type
    references:
      columns:
      - code
      schema: history_octane
      table: disclosure_action_type
  fkt_prp_doc_level_type:
    columns:
    - prp_doc_level_type
    references:
      columns:
      - code
      schema: history_octane
      table: doc_level_type
  fkt_prp_early_first_payment:
    columns:
    - prp_early_first_payment
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_earthquake_insurance_applicable:
    columns:
    - prp_earthquake_insurance_applicable
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_effective_property_value_explanation_type:
    columns:
    - prp_effective_property_value_explanation_type
    references:
      columns:
      - code
      schema: history_octane
      table: effective_property_value_explanation_type
  fkt_prp_effective_property_value_type:
    columns:
    - prp_effective_property_value_type
    references:
      columns:
      - code
      schema: history_octane
      table: effective_property_value_type
  fkt_prp_effective_signing_location_state:
    columns:
    - prp_effective_signing_location_state
    references:
      columns:
      - code
      schema: history_octane
      table: state_type
  fkt_prp_fha_eligible_maximum_financing:
    columns:
    - prp_fha_eligible_maximum_financing
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_fha_non_arms_length_ltv_exception_type:
    columns:
    - prp_fha_non_arms_length_ltv_exception_type
    references:
      columns:
      - code
      schema: history_octane
      table: fha_non_arms_length_ltv_limit_exception_type
  fkt_prp_financed_property_improvements_category_type:
    columns:
    - prp_financed_property_improvements_category_type
    references:
      columns:
      - code
      schema: history_octane
      table: financed_property_improvements_category_type
  fkt_prp_flood_insurance_applicable:
    columns:
    - prp_flood_insurance_applicable
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_fre_ctp_closing_feature_type:
    columns:
    - prp_fre_ctp_closing_feature_type
    references:
      columns:
      - code
      schema: history_octane
      table: fre_ctp_closing_feature_type
  fkt_prp_gse_version_type:
    columns:
    - prp_gse_version_type
    references:
      columns:
      - code
      schema: history_octane
      table: gse_version_type
  fkt_prp_hazard_insurance_applicable:
    columns:
    - prp_hazard_insurance_applicable
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_hud_consultant:
    columns:
    - prp_hud_consultant
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_hud_fha_de_approval_type:
    columns:
    - prp_hud_fha_de_approval_type
    references:
      columns:
      - code
      schema: history_octane
      table: hud_fha_de_approval_type
  fkt_prp_intent_to_proceed_type:
    columns:
    - prp_intent_to_proceed_type
    references:
      columns:
      - code
      schema: history_octane
      table: intent_to_proceed_type
  fkt_prp_loan_purpose_type:
    columns:
    - prp_loan_purpose_type
    references:
      columns:
      - code
      schema: history_octane
      table: loan_purpose_type
  fkt_prp_mortgagee_builder_seller_relationship:
    columns:
    - prp_mortgagee_builder_seller_relationship
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_non_business_cash_out_reason_acknowledged:
    columns:
    - prp_non_business_cash_out_reason_acknowledged
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_na_type
  fkt_prp_property_acquired_through_ancillary_relief:
    columns:
    - prp_property_acquired_through_ancillary_relief
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_property_acquired_through_inheritance:
    columns:
    - prp_property_acquired_through_inheritance
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_property_repairs_holdback_calc_type:
    columns:
    - prp_property_repairs_holdback_calc_type
    references:
      columns:
      - code
      schema: history_octane
      table: property_repairs_holdback_calc_type
  fkt_prp_property_repairs_holdback_payer_type:
    columns:
    - prp_property_repairs_holdback_payer_type
    references:
      columns:
      - code
      schema: history_octane
      table: property_repairs_holdback_payer_type
  fkt_prp_property_repairs_required_type:
    columns:
    - prp_property_repairs_required_type
    references:
      columns:
      - code
      schema: history_octane
      table: property_repairs_required_type
  fkt_prp_property_usage_type:
    columns:
    - prp_property_usage_type
    references:
      columns:
      - code
      schema: history_octane
      table: property_usage_type
  fkt_prp_proposal_type:
    columns:
    - prp_proposal_type
    references:
      columns:
      - code
      schema: history_octane
      table: proposal_type
  fkt_prp_rescission_notification_type:
    columns:
    - prp_rescission_notification_type
    references:
      columns:
      - code
      schema: history_octane
      table: rescission_notification_type
  fkt_prp_security_instrument_type:
    columns:
    - prp_security_instrument_type
    references:
      columns:
      - code
      schema: history_octane
      table: security_instrument_type
  fkt_prp_separate_transaction_for_land_acquisition:
    columns:
    - prp_separate_transaction_for_land_acquisition
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_structure_type:
    columns:
    - prp_structure_type
    references:
      columns:
      - code
      schema: history_octane
      table: proposal_structure_type
  fkt_prp_taxes_escrowed:
    columns:
    - prp_taxes_escrowed
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_trustee_address_country:
    columns:
    - prp_trustee_address_country
    references:
      columns:
      - code
      schema: history_octane
      table: country_type
  fkt_prp_underwrite_disposition_type:
    columns:
    - prp_underwrite_disposition_type
    references:
      columns:
      - code
      schema: history_octane
      table: underwrite_disposition_type
  fkt_prp_underwrite_method_type:
    columns:
    - prp_underwrite_method_type
    references:
      columns:
      - code
      schema: history_octane
      table: underwrite_method_type
  fkt_prp_underwrite_risk_assessment_type:
    columns:
    - prp_underwrite_risk_assessment_type
    references:
      columns:
      - code
      schema: history_octane
      table: underwrite_risk_assessment_type
  fkt_prp_usda_gsa_sam_exclusion:
    columns:
    - prp_usda_gsa_sam_exclusion
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_usda_rd_single_family_housing_type:
    columns:
    - prp_usda_rd_single_family_housing_type
    references:
      columns:
      - code
      schema: history_octane
      table: usda_rd_single_family_housing_type
  fkt_prp_va_meets_credit_standards:
    columns:
    - prp_va_meets_credit_standards
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_va_monthly_utilities_included:
    columns:
    - prp_va_monthly_utilities_included
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_va_notice_of_value_source_type:
    columns:
    - prp_va_notice_of_value_source_type
    references:
      columns:
      - code
      schema: history_octane
      table: va_notice_of_value_source_type
  fkt_prp_va_past_credit_record_type:
    columns:
    - prp_va_past_credit_record_type
    references:
      columns:
      - code
      schema: history_octane
      table: va_past_credit_record_type
  fkt_prp_vesting_change_titleholder_added:
    columns:
    - prp_vesting_change_titleholder_added
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_vesting_change_titleholder_name_change:
    columns:
    - prp_vesting_change_titleholder_name_change
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_vesting_change_titleholder_removed:
    columns:
    - prp_vesting_change_titleholder_removed
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
  fkt_prp_windstorm_insurance_applicable:
    columns:
    - prp_windstorm_insurance_applicable
    references:
      columns:
      - code
      schema: history_octane
      table: yes_no_unknown_type
columns:
  data_source_deleted_flag:
    data_type: BOOLEAN
  data_source_updated_datetime:
    data_type: TIMESTAMPTZ
  etl_batch_id:
    data_type: TEXT
  prp_adjusted_as_is_value_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.prp_adjusted_as_is_value_amount
  prp_after_improved_value_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.prp_after_improved_value_amount
  prp_anti_steering_lowest_cost_option_fee_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_anti_steering_lowest_cost_option_fee_amount
  prp_anti_steering_lowest_cost_option_rate_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.prp_anti_steering_lowest_cost_option_rate_percent
  prp_anti_steering_lowest_rate_option_fee_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_anti_steering_lowest_rate_option_fee_amount
  prp_anti_steering_lowest_rate_option_rate_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.prp_anti_steering_lowest_rate_option_rate_percent
  prp_anti_steering_lowest_rate_wo_neg_option_fee_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_anti_steering_lowest_rate_wo_neg_option_fee_amount
  prp_anti_steering_lowest_rate_wo_neg_option_rate_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.prp_anti_steering_lowest_rate_wo_neg_option_rate_percent
  prp_any_disaster_declaration:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_any_disaster_declaration
  prp_any_disaster_declaration_after_appraisal:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_any_disaster_declaration_after_appraisal
  prp_any_disaster_declaration_before_appraisal:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_any_disaster_declaration_before_appraisal
  prp_any_vesting_changes:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_any_vesting_changes
  prp_area_median_income:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_area_median_income
  prp_arms_length:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_arms_length
  prp_calculated_earliest_allowed_consummation_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_calculated_earliest_allowed_consummation_date
  prp_cash_out_reason_business_debt_or_debt_consolidation:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_cash_out_reason_business_debt_or_debt_consolidation
  prp_cash_out_reason_debt_or_debt_consolidation:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_cash_out_reason_debt_or_debt_consolidation
  prp_cash_out_reason_future_investment_not_under_contract:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_cash_out_reason_future_investment_not_under_contract
  prp_cash_out_reason_future_investment_under_contract:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_cash_out_reason_future_investment_under_contract
  prp_cash_out_reason_home_improvement:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_cash_out_reason_home_improvement
  prp_cash_out_reason_investment_or_business_property:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_cash_out_reason_investment_or_business_property
  prp_cash_out_reason_other:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_cash_out_reason_other
  prp_cash_out_reason_other_text:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_cash_out_reason_other_text
  prp_cash_out_reason_personal_use:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_cash_out_reason_personal_use
  prp_cash_out_reason_student_loans:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_cash_out_reason_student_loans
  prp_cd_clear_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_cd_clear_date
  prp_cema:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_cema
  prp_cema_borrower_savings:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_cema_borrower_savings
  prp_charges_updated_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_charges_updated_datetime
  prp_closing_document_sign_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_closing_document_sign_datetime
  prp_construction_borrower_contribution_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_construction_borrower_contribution_amount
  prp_construction_lot_ownership_status_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_construction_lot_ownership_status_type
  prp_cr_tracker_url:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.columns.prp_cr_tracker_url
  prp_create_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_create_datetime
  prp_deal_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.prp_deal_pid
  prp_decision_appraised_value_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.prp_decision_appraised_value_amount
  prp_decision_credit_score:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_decision_credit_score
  prp_decision_credit_score_borrower_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.prp_decision_credit_score_borrower_pid
  prp_decision_du_request_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.prp_decision_du_request_pid
  prp_decision_lp_request_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.prp_decision_lp_request_pid
  prp_decision_veteran_borrower_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.prp_decision_veteran_borrower_pid
  prp_deed_taxes_applicable:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_deed_taxes_applicable
  prp_deed_taxes_applicable_explanation:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.columns.prp_deed_taxes_applicable_explanation
  prp_deed_taxes_auto_compute:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_deed_taxes_auto_compute
  prp_deed_taxes_auto_compute_override_reason:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.columns.prp_deed_taxes_auto_compute_override_reason
  prp_delayed_financing_exception_guidelines_applicable:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_delayed_financing_exception_guidelines_applicable
  prp_delayed_financing_exception_verified:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_delayed_financing_exception_verified
  prp_description:
    data_type: VARCHAR(256)
    source:
      field: primary_source_table.columns.prp_description
  prp_disaster_declaration_check_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_disaster_declaration_check_date
  prp_disaster_declaration_check_date_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_disaster_declaration_check_date_type
  prp_disclosure_action_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_disclosure_action_type
  prp_doc_level_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_doc_level_type
  prp_docs_enabled_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_docs_enabled_datetime
  prp_down_payment_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.prp_down_payment_percent
  prp_down_payment_percent_mode:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_down_payment_percent_mode
  prp_earliest_allowed_consummation_date_override_reason:
    data_type: TEXT
    source:
      field: primary_source_table.columns.prp_earliest_allowed_consummation_date_override_reason
  prp_early_first_payment:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_early_first_payment
  prp_earthquake_insurance_applicable:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_earthquake_insurance_applicable
  prp_effective_credit_score:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_effective_credit_score
  prp_effective_earliest_allowed_consummation_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_effective_earliest_allowed_consummation_date
  prp_effective_funding_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_effective_funding_date
  prp_effective_note_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_effective_note_date
  prp_effective_property_value_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.prp_effective_property_value_amount
  prp_effective_property_value_explanation_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_effective_property_value_explanation_type
  prp_effective_property_value_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_effective_property_value_type
  prp_effective_signing_location_city:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_effective_signing_location_city
  prp_effective_signing_location_state:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_effective_signing_location_state
  prp_escrow_cushion_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_escrow_cushion_months
  prp_escrow_cushion_months_auto_compute:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_escrow_cushion_months_auto_compute
  prp_estimated_credit_score:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_estimated_credit_score
  prp_estimated_funding_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_estimated_funding_date
  prp_estimated_hard_construction_cost_amount:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.prp_estimated_hard_construction_cost_amount
  prp_estimated_property_value_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.prp_estimated_property_value_amount
  prp_fha_203k_consultant_id:
    data_type: VARCHAR(8)
  prp_fha_eligible_maximum_financing:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_fha_eligible_maximum_financing
  prp_fha_mip_refund_request_input_error:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_fha_mip_refund_request_input_error
  prp_fha_non_arms_length_ltv_exception_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_fha_non_arms_length_ltv_exception_type
  prp_fha_non_arms_length_ltv_exception_verified:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_fha_non_arms_length_ltv_exception_verified
  prp_fha_prior_agency_case_endorsement_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_fha_prior_agency_case_endorsement_date
  prp_fha_prior_agency_case_id:
    data_type: VARCHAR(32)
    source:
      field: primary_source_table.columns.prp_fha_prior_agency_case_id
  prp_fha_refinance_authorization_expiration_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_fha_refinance_authorization_expiration_date
  prp_fha_refinance_authorization_number:
    data_type: VARCHAR(16)
    source:
      field: primary_source_table.columns.prp_fha_refinance_authorization_number
  prp_fha_va_reasonable_value_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.prp_fha_va_reasonable_value_amount
  prp_fhac_refinance_authorization_messages:
    data_type: TEXT
    source:
      field: primary_source_table.columns.prp_fhac_refinance_authorization_messages
  prp_financed_property_improvements:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_financed_property_improvements
  prp_financed_property_improvements_category_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_financed_property_improvements_category_type
  prp_first_payment_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_first_payment_date
  prp_first_payment_date_auto_compute:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_first_payment_date_auto_compute
  prp_flood_insurance_applicable:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_flood_insurance_applicable
  prp_fre_ctp_closing_feature_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_fre_ctp_closing_feature_type
  prp_fre_ctp_closing_type:
    data_type: VARCHAR(128)
  prp_fre_ctp_first_payment_due_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_fre_ctp_first_payment_due_date
  prp_gfe_interest_rate_expiration_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_gfe_interest_rate_expiration_date
  prp_gfe_lock_before_settlement_days:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_gfe_lock_before_settlement_days
  prp_gfe_lock_duration_days:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_gfe_lock_duration_days
  prp_gse_version_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_gse_version_type
  prp_hazard_insurance_applicable:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_hazard_insurance_applicable
  prp_household_income_exclusive_edit:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_household_income_exclusive_edit
  prp_household_size_count:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_household_size_count
  prp_hud_consultant:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_hud_consultant
  prp_hud_fha_de_approval_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_hud_fha_de_approval_type
  prp_initial_uw_disposition_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_initial_uw_disposition_datetime
  prp_initial_uw_submit_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_initial_uw_submit_datetime
  prp_intent_to_proceed_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_intent_to_proceed_date
  prp_intent_to_proceed_obtainer_unparsed_name:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_intent_to_proceed_obtainer_unparsed_name
  prp_intent_to_proceed_provided:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_intent_to_proceed_provided
  prp_intent_to_proceed_provider_unparsed_name:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_intent_to_proceed_provider_unparsed_name
  prp_intent_to_proceed_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_intent_to_proceed_type
  prp_ipc_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_ipc_amount
  prp_ipc_auto_compute:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_ipc_auto_compute
  prp_ipc_financing_concession_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_ipc_financing_concession_amount
  prp_ipc_limit_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.prp_ipc_limit_percent
  prp_ipc_maximum_amount_allowed:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_ipc_maximum_amount_allowed
  prp_ipc_non_cash_concession_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_ipc_non_cash_concession_amount
  prp_ipc_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.prp_ipc_percent
  prp_land_acquisition_price:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.prp_land_acquisition_price
  prp_land_acquisition_transaction_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_land_acquisition_transaction_date
  prp_last_corrective_disclosure_processed_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_last_corrective_disclosure_processed_datetime
  prp_last_requested_disclosure_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_last_requested_disclosure_date
  prp_lender_escrow_loan_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_lender_escrow_loan_amount
  prp_lender_escrow_loan_due_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_lender_escrow_loan_due_date
  prp_loan_modification_agreement_executed_received_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_loan_modification_agreement_executed_received_datetime
  prp_loan_purpose_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_loan_purpose_type
  prp_mi_required:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_mi_required
  prp_minimum_household_income_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_minimum_household_income_amount
  prp_minimum_residual_income_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_minimum_residual_income_amount
  prp_minimum_residual_income_auto_compute:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_minimum_residual_income_auto_compute
  prp_mortgagee_builder_seller_relationship:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_mortgagee_builder_seller_relationship
  prp_name:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_name
  prp_non_business_cash_out_reason_acknowledged:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_non_business_cash_out_reason_acknowledged
  prp_note_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_note_date
  prp_other_lender_requires_appraisal:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_other_lender_requires_appraisal
  prp_other_lender_requires_appraisal_reason:
    data_type: TEXT
    source:
      field: primary_source_table.columns.prp_other_lender_requires_appraisal_reason
  prp_overridden_earliest_allowed_consummation_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_overridden_earliest_allowed_consummation_date
  prp_owner_occupancy_not_required:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_owner_occupancy_not_required
  prp_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.prp_pid
  prp_preapproval_complete_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_preapproval_complete_datetime
  prp_preapproval_disposition_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_preapproval_disposition_datetime
  prp_property_acquired_through_ancillary_relief:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_property_acquired_through_ancillary_relief
  prp_property_acquired_through_inheritance:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_property_acquired_through_inheritance
  prp_property_repairs_completed_notification_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_property_repairs_completed_notification_date
  prp_property_repairs_cost_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_property_repairs_cost_amount
  prp_property_repairs_description:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.columns.prp_property_repairs_description
  prp_property_repairs_funds_released_contractor_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_property_repairs_funds_released_contractor_date
  prp_property_repairs_holdback_administrator:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_property_repairs_holdback_administrator
  prp_property_repairs_holdback_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_property_repairs_holdback_amount
  prp_property_repairs_holdback_calc_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_property_repairs_holdback_calc_type
  prp_property_repairs_holdback_payer_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_property_repairs_holdback_payer_type
  prp_property_repairs_holdback_required_completion_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_property_repairs_holdback_required_completion_date
  prp_property_repairs_inspection_completed_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_property_repairs_inspection_completed_date
  prp_property_repairs_inspection_ordered_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_property_repairs_inspection_ordered_date
  prp_property_repairs_required_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_property_repairs_required_type
  prp_property_tax_request_error_messages:
    data_type: TEXT
    source:
      field: primary_source_table.columns.prp_property_tax_request_error_messages
  prp_property_taxes_request_input_error:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_property_taxes_request_input_error
  prp_property_usage_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_property_usage_type
  prp_proposal_expiration_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_proposal_expiration_date
  prp_proposal_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_proposal_type
  prp_proposed_additional_monthly_payment:
    data_type: NUMERIC(17,2)
    source:
      field: primary_source_table.columns.prp_proposed_additional_monthly_payment
  prp_publish:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_publish
  prp_publish_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_publish_date
  prp_purchase_contract_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_purchase_contract_date
  prp_purchase_contract_financing_contingency_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_purchase_contract_financing_contingency_date
  prp_purchase_contract_funding_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_purchase_contract_funding_date
  prp_purchase_contract_received_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_purchase_contract_received_date
  prp_recording_fees_request_input_error:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_recording_fees_request_input_error
  prp_request_fha_mip_refund_required:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_request_fha_mip_refund_required
  prp_request_property_taxes_required:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_request_property_taxes_required
  prp_request_recording_fees_required:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_request_recording_fees_required
  prp_rescission_applicable:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_rescission_applicable
  prp_rescission_effective_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_rescission_effective_date
  prp_rescission_notification_by:
    data_type: VARCHAR(256)
    source:
      field: primary_source_table.columns.prp_rescission_notification_by
  prp_rescission_notification_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_rescission_notification_date
  prp_rescission_notification_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_rescission_notification_type
  prp_rescission_through_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_rescission_through_date
  prp_reserves_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_reserves_amount
  prp_reserves_auto_compute:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_reserves_auto_compute
  prp_reserves_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_reserves_months
  prp_sale_price_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.prp_sale_price_amount
  prp_sar_significant_adjustments:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_sar_significant_adjustments
  prp_scheduled_closing_document_sign_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_scheduled_closing_document_sign_datetime
  prp_security_instrument_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_security_instrument_type
  prp_separate_transaction_for_land_acquisition:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_separate_transaction_for_land_acquisition
  prp_signed_closing_doc_received_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_signed_closing_doc_received_datetime
  prp_smart_charges_enabled:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_smart_charges_enabled
  prp_smart_docs_enabled:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_smart_docs_enabled
  prp_structure_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_structure_type
  prp_taxes_escrowed:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_taxes_escrowed
  prp_term_borrower_intends_to_retain_property:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_term_borrower_intends_to_retain_property
  prp_texas_equity_conversion_determ_datetime_override_reason:
    data_type: TEXT
    source:
      field: primary_source_table.columns.prp_texas_equity_conversion_determ_datetime_override_reason
  prp_texas_equity_conversion_determination_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_texas_equity_conversion_determination_datetime
  prp_texas_equity_conversion_determination_datetime_override:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_texas_equity_conversion_determination_datetime_override
  prp_texas_equity_determination_datetime:
    data_type: TIMESTAMP
    source:
      field: primary_source_table.columns.prp_texas_equity_determination_datetime
  prp_texas_equity_determination_datetime_override:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_texas_equity_determination_datetime_override
  prp_texas_equity_determination_datetime_override_reason:
    data_type: TEXT
    source:
      field: primary_source_table.columns.prp_texas_equity_determination_datetime_override_reason
  prp_total_income_to_ami_ratio:
    data_type: NUMERIC(14,9)
    source:
      field: primary_source_table.columns.prp_total_income_to_ami_ratio
  prp_trustee_address_city:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_trustee_address_city
  prp_trustee_address_country:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_trustee_address_country
  prp_trustee_address_postal_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_trustee_address_postal_code
  prp_trustee_address_state:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_trustee_address_state
  prp_trustee_address_street1:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_trustee_address_street1
  prp_trustee_address_street2:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_trustee_address_street2
  prp_trustee_mers_org_id:
    data_type: VARCHAR(7)
    source:
      field: primary_source_table.columns.prp_trustee_mers_org_id
  prp_trustee_name:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_trustee_name
  prp_trustee_phone_number:
    data_type: VARCHAR(32)
    source:
      field: primary_source_table.columns.prp_trustee_phone_number
  prp_trustee_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.prp_trustee_pid
  prp_underwrite_disposition_note:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.columns.prp_underwrite_disposition_note
  prp_underwrite_disposition_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_underwrite_disposition_type
  prp_underwrite_expiration_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_underwrite_expiration_date
  prp_underwrite_method_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_underwrite_method_type
  prp_underwrite_publish_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_underwrite_publish_date
  prp_underwrite_risk_assessment_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_underwrite_risk_assessment_type
  prp_underwriting_comments:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.columns.prp_underwriting_comments
  prp_usda_gsa_sam_checked_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_usda_gsa_sam_checked_date
  prp_usda_gsa_sam_exclusion:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_usda_gsa_sam_exclusion
  prp_usda_rd_single_family_housing_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_usda_rd_single_family_housing_type
  prp_user_entered_note_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_user_entered_note_date
  prp_uuts_master_contact_name:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_uuts_master_contact_name
  prp_uuts_master_contact_title:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_uuts_master_contact_title
  prp_uuts_master_office_phone:
    data_type: VARCHAR(32)
    source:
      field: primary_source_table.columns.prp_uuts_master_office_phone
  prp_uuts_master_office_phone_extension:
    data_type: VARCHAR(16)
    source:
      field: primary_source_table.columns.prp_uuts_master_office_phone_extension
  prp_va_actual_guaranty_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_actual_guaranty_amount
  prp_va_amount_used_to_calculate_maximum_guaranty:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_amount_used_to_calculate_maximum_guaranty
  prp_va_energy_efficient_improvements_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_energy_efficient_improvements_amount
  prp_va_guaranty_percent:
    data_type: NUMERIC(11,9)
    source:
      field: primary_source_table.columns.prp_va_guaranty_percent
  prp_va_maintenance_utilities_auto_compute:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.prp_va_maintenance_utilities_auto_compute
  prp_va_maintenance_utilities_per_square_feet_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_maintenance_utilities_per_square_feet_amount
  prp_va_maximum_base_loan_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_maximum_base_loan_amount
  prp_va_maximum_funding_fee_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_maximum_funding_fee_amount
  prp_va_maximum_total_loan_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_maximum_total_loan_amount
  prp_va_meets_credit_standards:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_va_meets_credit_standards
  prp_va_monthly_maintenance_utilities_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_monthly_maintenance_utilities_amount
  prp_va_monthly_utilities_included:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_va_monthly_utilities_included
  prp_va_notice_of_value_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.prp_va_notice_of_value_date
  prp_va_notice_of_value_estimated_reasonable_value_amount:
    data_type: NUMERIC(15,0)
    source:
      field: primary_source_table.columns.prp_va_notice_of_value_estimated_reasonable_value_amount
  prp_va_notice_of_value_source_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_va_notice_of_value_source_type
  prp_va_past_credit_record_type:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_va_past_credit_record_type
  prp_va_prior_paid_in_full_loan_number:
    data_type: VARCHAR(32)
    source:
      field: primary_source_table.columns.prp_va_prior_paid_in_full_loan_number
  prp_va_required_cash_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_required_cash_amount
  prp_va_required_guaranty_amount:
    data_type: NUMERIC(15,2)
    source:
      field: primary_source_table.columns.prp_va_required_guaranty_amount
  prp_version:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.prp_version
  prp_vesting_change_titleholder_added:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_vesting_change_titleholder_added
  prp_vesting_change_titleholder_name_change:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_vesting_change_titleholder_name_change
  prp_vesting_change_titleholder_removed:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_vesting_change_titleholder_removed
  prp_windstorm_insurance_applicable:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.prp_windstorm_insurance_applicable
step_functions:
  SP-100317:
    etls:
      ETL-100317:
        input_type: table
        output_type: insert
        output_table: staging.history_octane.proposal
        json_output_field: prp_pid
        truncate_table: false
        container_memory: 4096
        next_step_functions:
        - SP-200012
        - SP-200014
        - SP-200019
        - SP-200020
        - SP-200023
        - SP-200025
        - SP-200026
        - SP-200027
        - SP-200028
        - SP-200029
        - SP-300001-delete
        input_sql: |-
          --finding records to insert into history_octane.proposal
          SELECT staging_table.prp_pid
               , staging_table.prp_version
               , staging_table.prp_decision_lp_request_pid
               , staging_table.prp_decision_du_request_pid
               , staging_table.prp_proposal_type
               , staging_table.prp_description
               , staging_table.prp_doc_level_type
               , staging_table.prp_loan_purpose_type
               , staging_table.prp_name
               , staging_table.prp_create_datetime
               , staging_table.prp_effective_funding_date
               , staging_table.prp_estimated_funding_date
               , staging_table.prp_calculated_earliest_allowed_consummation_date
               , staging_table.prp_overridden_earliest_allowed_consummation_date
               , staging_table.prp_effective_earliest_allowed_consummation_date
               , staging_table.prp_earliest_allowed_consummation_date_override_reason
               , staging_table.prp_last_requested_disclosure_date
               , staging_table.prp_closing_document_sign_datetime
               , staging_table.prp_scheduled_closing_document_sign_datetime
               , staging_table.prp_rescission_through_date
               , staging_table.prp_rescission_notification_date
               , staging_table.prp_rescission_notification_by
               , staging_table.prp_rescission_notification_type
               , staging_table.prp_rescission_effective_date
               , staging_table.prp_first_payment_date
               , staging_table.prp_first_payment_date_auto_compute
               , staging_table.prp_property_usage_type
               , staging_table.prp_estimated_property_value_amount
               , staging_table.prp_smart_charges_enabled
               , staging_table.prp_charges_updated_datetime
               , staging_table.prp_smart_docs_enabled
               , staging_table.prp_docs_enabled_datetime
               , staging_table.prp_request_fha_mip_refund_required
               , staging_table.prp_request_recording_fees_required
               , staging_table.prp_request_property_taxes_required
               , staging_table.prp_property_tax_request_error_messages
               , staging_table.prp_fha_mip_refund_request_input_error
               , staging_table.prp_recording_fees_request_input_error
               , staging_table.prp_property_taxes_request_input_error
               , staging_table.prp_publish
               , staging_table.prp_publish_date
               , staging_table.prp_ipc_auto_compute
               , staging_table.prp_ipc_limit_percent
               , staging_table.prp_ipc_maximum_amount_allowed
               , staging_table.prp_ipc_amount
               , staging_table.prp_ipc_percent
               , staging_table.prp_ipc_financing_concession_amount
               , staging_table.prp_ipc_non_cash_concession_amount
               , staging_table.prp_sale_price_amount
               , staging_table.prp_structure_type
               , staging_table.prp_deal_pid
               , staging_table.prp_gfe_interest_rate_expiration_date
               , staging_table.prp_gfe_lock_duration_days
               , staging_table.prp_gfe_lock_before_settlement_days
               , staging_table.prp_proposal_expiration_date
               , staging_table.prp_uuts_master_contact_name
               , staging_table.prp_uuts_master_contact_title
               , staging_table.prp_uuts_master_office_phone
               , staging_table.prp_uuts_master_office_phone_extension
               , staging_table.prp_underwrite_risk_assessment_type
               , staging_table.prp_underwriting_comments
               , staging_table.prp_reserves_auto_compute
               , staging_table.prp_reserves_amount
               , staging_table.prp_reserves_months
               , staging_table.prp_underwrite_disposition_type
               , staging_table.prp_underwrite_publish_date
               , staging_table.prp_underwrite_expiration_date
               , staging_table.prp_usda_gsa_sam_exclusion
               , staging_table.prp_usda_gsa_sam_checked_date
               , staging_table.prp_usda_rd_single_family_housing_type
               , staging_table.prp_underwrite_method_type
               , staging_table.prp_mi_required
               , staging_table.prp_decision_credit_score_borrower_pid
               , staging_table.prp_decision_credit_score
               , staging_table.prp_estimated_credit_score
               , staging_table.prp_effective_credit_score
               , staging_table.prp_mortgagee_builder_seller_relationship
               , staging_table.prp_fha_prior_agency_case_id
               , staging_table.prp_fha_prior_agency_case_endorsement_date
               , staging_table.prp_fha_refinance_authorization_number
               , staging_table.prp_fha_refinance_authorization_expiration_date
               , staging_table.prp_fhac_refinance_authorization_messages
               , staging_table.prp_hud_fha_de_approval_type
               , staging_table.prp_owner_occupancy_not_required
               , staging_table.prp_va_monthly_utilities_included
               , staging_table.prp_va_maintenance_utilities_auto_compute
               , staging_table.prp_va_monthly_maintenance_utilities_amount
               , staging_table.prp_va_maintenance_utilities_per_square_feet_amount
               , staging_table.prp_household_size_count
               , staging_table.prp_va_past_credit_record_type
               , staging_table.prp_va_meets_credit_standards
               , staging_table.prp_va_prior_paid_in_full_loan_number
               , staging_table.prp_note_date
               , staging_table.prp_security_instrument_type
               , staging_table.prp_trustee_pid
               , staging_table.prp_trustee_name
               , staging_table.prp_trustee_address_street1
               , staging_table.prp_trustee_address_street2
               , staging_table.prp_trustee_address_city
               , staging_table.prp_trustee_address_state
               , staging_table.prp_trustee_address_postal_code
               , staging_table.prp_trustee_address_country
               , staging_table.prp_trustee_mers_org_id
               , staging_table.prp_trustee_phone_number
               , staging_table.prp_fre_ctp_closing_feature_type
               , staging_table.prp_fre_ctp_first_payment_due_date
               , staging_table.prp_purchase_contract_date
               , staging_table.prp_purchase_contract_financing_contingency_date
               , staging_table.prp_purchase_contract_funding_date
               , staging_table.prp_effective_property_value_type
               , staging_table.prp_effective_property_value_amount
               , staging_table.prp_decision_appraised_value_amount
               , staging_table.prp_fha_va_reasonable_value_amount
               , staging_table.prp_cd_clear_date
               , staging_table.prp_disaster_declaration_check_date_type
               , staging_table.prp_disaster_declaration_check_date
               , staging_table.prp_any_disaster_declaration_before_appraisal
               , staging_table.prp_any_disaster_declaration_after_appraisal
               , staging_table.prp_any_disaster_declaration
               , staging_table.prp_early_first_payment
               , staging_table.prp_property_acquired_through_inheritance
               , staging_table.prp_property_acquired_through_ancillary_relief
               , staging_table.prp_delayed_financing_exception_guidelines_applicable
               , staging_table.prp_delayed_financing_exception_verified
               , staging_table.prp_effective_property_value_explanation_type
               , staging_table.prp_taxes_escrowed
               , staging_table.prp_flood_insurance_applicable
               , staging_table.prp_windstorm_insurance_applicable
               , staging_table.prp_earthquake_insurance_applicable
               , staging_table.prp_arms_length
               , staging_table.prp_fha_non_arms_length_ltv_exception_type
               , staging_table.prp_fha_non_arms_length_ltv_exception_verified
               , staging_table.prp_escrow_cushion_months
               , staging_table.prp_escrow_cushion_months_auto_compute
               , staging_table.prp_fha_eligible_maximum_financing
               , staging_table.prp_hazard_insurance_applicable
               , staging_table.prp_property_repairs_required_type
               , staging_table.prp_property_repairs_description
               , staging_table.prp_property_repairs_cost_amount
               , staging_table.prp_property_repairs_holdback_calc_type
               , staging_table.prp_property_repairs_holdback_amount
               , staging_table.prp_property_repairs_holdback_payer_type
               , staging_table.prp_property_repairs_holdback_administrator
               , staging_table.prp_property_repairs_holdback_required_completion_date
               , staging_table.prp_property_repairs_completed_notification_date
               , staging_table.prp_property_repairs_inspection_ordered_date
               , staging_table.prp_property_repairs_inspection_completed_date
               , staging_table.prp_property_repairs_funds_released_contractor_date
               , staging_table.prp_anti_steering_lowest_rate_option_rate_percent
               , staging_table.prp_anti_steering_lowest_rate_option_fee_amount
               , staging_table.prp_anti_steering_lowest_rate_wo_neg_option_rate_percent
               , staging_table.prp_anti_steering_lowest_rate_wo_neg_option_fee_amount
               , staging_table.prp_anti_steering_lowest_cost_option_rate_percent
               , staging_table.prp_anti_steering_lowest_cost_option_fee_amount
               , staging_table.prp_initial_uw_submit_datetime
               , staging_table.prp_va_notice_of_value_source_type
               , staging_table.prp_va_notice_of_value_date
               , staging_table.prp_va_notice_of_value_estimated_reasonable_value_amount
               , staging_table.prp_sar_significant_adjustments
               , staging_table.prp_separate_transaction_for_land_acquisition
               , staging_table.prp_land_acquisition_transaction_date
               , staging_table.prp_land_acquisition_price
               , staging_table.prp_cash_out_reason_home_improvement
               , staging_table.prp_cash_out_reason_debt_or_debt_consolidation
               , staging_table.prp_cash_out_reason_personal_use
               , staging_table.prp_cash_out_reason_future_investment_not_under_contract
               , staging_table.prp_cash_out_reason_future_investment_under_contract
               , staging_table.prp_cash_out_reason_other
               , staging_table.prp_cash_out_reason_other_text
               , staging_table.prp_decision_veteran_borrower_pid
               , staging_table.prp_signed_closing_doc_received_datetime
               , staging_table.prp_other_lender_requires_appraisal
               , staging_table.prp_other_lender_requires_appraisal_reason
               , staging_table.prp_texas_equity_determination_datetime
               , staging_table.prp_texas_equity_conversion_determination_datetime
               , staging_table.prp_texas_equity_determination_datetime_override
               , staging_table.prp_texas_equity_determination_datetime_override_reason
               , staging_table.prp_texas_equity_conversion_determination_datetime_override
               , staging_table.prp_texas_equity_conversion_determ_datetime_override_reason
               , staging_table.prp_cema
               , staging_table.prp_cema_borrower_savings
               , staging_table.prp_any_vesting_changes
               , staging_table.prp_vesting_change_titleholder_added
               , staging_table.prp_vesting_change_titleholder_removed
               , staging_table.prp_vesting_change_titleholder_name_change
               , staging_table.prp_deed_taxes_applicable
               , staging_table.prp_deed_taxes_applicable_explanation
               , staging_table.prp_deed_taxes_auto_compute
               , staging_table.prp_deed_taxes_auto_compute_override_reason
               , staging_table.prp_intent_to_proceed_date
               , staging_table.prp_intent_to_proceed_type
               , staging_table.prp_intent_to_proceed_provider_unparsed_name
               , staging_table.prp_intent_to_proceed_obtainer_unparsed_name
               , staging_table.prp_cash_out_reason_student_loans
               , staging_table.prp_household_income_exclusive_edit
               , staging_table.prp_purchase_contract_received_date
               , staging_table.prp_down_payment_percent_mode
               , staging_table.prp_lender_escrow_loan_amount
               , staging_table.prp_underwrite_disposition_note
               , staging_table.prp_rescission_applicable
               , staging_table.prp_area_median_income
               , staging_table.prp_total_income_to_ami_ratio
               , staging_table.prp_cr_tracker_url
               , staging_table.prp_construction_borrower_contribution_amount
               , staging_table.prp_construction_lot_ownership_status_type
               , staging_table.prp_intent_to_proceed_provided
               , staging_table.prp_effective_signing_location_state
               , staging_table.prp_effective_signing_location_city
               , staging_table.prp_va_required_guaranty_amount
               , staging_table.prp_va_amount_used_to_calculate_maximum_guaranty
               , staging_table.prp_va_actual_guaranty_amount
               , staging_table.prp_last_corrective_disclosure_processed_datetime
               , staging_table.prp_user_entered_note_date
               , staging_table.prp_effective_note_date
               , staging_table.prp_lender_escrow_loan_due_date
               , staging_table.prp_va_maximum_base_loan_amount
               , staging_table.prp_va_maximum_funding_fee_amount
               , staging_table.prp_va_maximum_total_loan_amount
               , staging_table.prp_va_required_cash_amount
               , staging_table.prp_va_guaranty_percent
               , staging_table.prp_gse_version_type
               , staging_table.prp_minimum_household_income_amount
               , staging_table.prp_minimum_residual_income_amount
               , staging_table.prp_minimum_residual_income_auto_compute
               , staging_table.prp_financed_property_improvements_category_type
               , staging_table.prp_adjusted_as_is_value_amount
               , staging_table.prp_after_improved_value_amount
               , staging_table.prp_hud_consultant
               , staging_table.prp_disclosure_action_type
               , staging_table.prp_financed_property_improvements
               , staging_table.prp_estimated_hard_construction_cost_amount
               , staging_table.prp_initial_uw_disposition_datetime
               , staging_table.prp_preapproval_complete_datetime
               , staging_table.prp_preapproval_disposition_datetime
               , staging_table.prp_down_payment_percent
               , staging_table.prp_cash_out_reason_investment_or_business_property
               , staging_table.prp_cash_out_reason_business_debt_or_debt_consolidation
               , staging_table.prp_non_business_cash_out_reason_acknowledged
               , staging_table.prp_va_energy_efficient_improvements_amount
               , staging_table.prp_proposed_additional_monthly_payment
               , staging_table.prp_term_borrower_intends_to_retain_property
               , staging_table.prp_loan_modification_agreement_executed_received_datetime
               , FALSE AS data_source_deleted_flag
               , NOW( ) AS data_source_updated_datetime
          FROM staging_octane.proposal staging_table
          LEFT JOIN history_octane.proposal history_table
                    ON staging_table.prp_pid = history_table.prp_pid
                        AND staging_table.prp_version = history_table.prp_version
          WHERE history_table.prp_pid IS NULL
          UNION ALL
          SELECT history_table.prp_pid
               , history_table.prp_version + 1
               , history_table.prp_decision_lp_request_pid
               , history_table.prp_decision_du_request_pid
               , history_table.prp_proposal_type
               , history_table.prp_description
               , history_table.prp_doc_level_type
               , history_table.prp_loan_purpose_type
               , history_table.prp_name
               , history_table.prp_create_datetime
               , history_table.prp_effective_funding_date
               , history_table.prp_estimated_funding_date
               , history_table.prp_calculated_earliest_allowed_consummation_date
               , history_table.prp_overridden_earliest_allowed_consummation_date
               , history_table.prp_effective_earliest_allowed_consummation_date
               , history_table.prp_earliest_allowed_consummation_date_override_reason
               , history_table.prp_last_requested_disclosure_date
               , history_table.prp_closing_document_sign_datetime
               , history_table.prp_scheduled_closing_document_sign_datetime
               , history_table.prp_rescission_through_date
               , history_table.prp_rescission_notification_date
               , history_table.prp_rescission_notification_by
               , history_table.prp_rescission_notification_type
               , history_table.prp_rescission_effective_date
               , history_table.prp_first_payment_date
               , history_table.prp_first_payment_date_auto_compute
               , history_table.prp_property_usage_type
               , history_table.prp_estimated_property_value_amount
               , history_table.prp_smart_charges_enabled
               , history_table.prp_charges_updated_datetime
               , history_table.prp_smart_docs_enabled
               , history_table.prp_docs_enabled_datetime
               , history_table.prp_request_fha_mip_refund_required
               , history_table.prp_request_recording_fees_required
               , history_table.prp_request_property_taxes_required
               , history_table.prp_property_tax_request_error_messages
               , history_table.prp_fha_mip_refund_request_input_error
               , history_table.prp_recording_fees_request_input_error
               , history_table.prp_property_taxes_request_input_error
               , history_table.prp_publish
               , history_table.prp_publish_date
               , history_table.prp_ipc_auto_compute
               , history_table.prp_ipc_limit_percent
               , history_table.prp_ipc_maximum_amount_allowed
               , history_table.prp_ipc_amount
               , history_table.prp_ipc_percent
               , history_table.prp_ipc_financing_concession_amount
               , history_table.prp_ipc_non_cash_concession_amount
               , history_table.prp_sale_price_amount
               , history_table.prp_structure_type
               , history_table.prp_deal_pid
               , history_table.prp_gfe_interest_rate_expiration_date
               , history_table.prp_gfe_lock_duration_days
               , history_table.prp_gfe_lock_before_settlement_days
               , history_table.prp_proposal_expiration_date
               , history_table.prp_uuts_master_contact_name
               , history_table.prp_uuts_master_contact_title
               , history_table.prp_uuts_master_office_phone
               , history_table.prp_uuts_master_office_phone_extension
               , history_table.prp_underwrite_risk_assessment_type
               , history_table.prp_underwriting_comments
               , history_table.prp_reserves_auto_compute
               , history_table.prp_reserves_amount
               , history_table.prp_reserves_months
               , history_table.prp_underwrite_disposition_type
               , history_table.prp_underwrite_publish_date
               , history_table.prp_underwrite_expiration_date
               , history_table.prp_usda_gsa_sam_exclusion
               , history_table.prp_usda_gsa_sam_checked_date
               , history_table.prp_usda_rd_single_family_housing_type
               , history_table.prp_underwrite_method_type
               , history_table.prp_mi_required
               , history_table.prp_decision_credit_score_borrower_pid
               , history_table.prp_decision_credit_score
               , history_table.prp_estimated_credit_score
               , history_table.prp_effective_credit_score
               , history_table.prp_mortgagee_builder_seller_relationship
               , history_table.prp_fha_prior_agency_case_id
               , history_table.prp_fha_prior_agency_case_endorsement_date
               , history_table.prp_fha_refinance_authorization_number
               , history_table.prp_fha_refinance_authorization_expiration_date
               , history_table.prp_fhac_refinance_authorization_messages
               , history_table.prp_hud_fha_de_approval_type
               , history_table.prp_owner_occupancy_not_required
               , history_table.prp_va_monthly_utilities_included
               , history_table.prp_va_maintenance_utilities_auto_compute
               , history_table.prp_va_monthly_maintenance_utilities_amount
               , history_table.prp_va_maintenance_utilities_per_square_feet_amount
               , history_table.prp_household_size_count
               , history_table.prp_va_past_credit_record_type
               , history_table.prp_va_meets_credit_standards
               , history_table.prp_va_prior_paid_in_full_loan_number
               , history_table.prp_note_date
               , history_table.prp_security_instrument_type
               , history_table.prp_trustee_pid
               , history_table.prp_trustee_name
               , history_table.prp_trustee_address_street1
               , history_table.prp_trustee_address_street2
               , history_table.prp_trustee_address_city
               , history_table.prp_trustee_address_state
               , history_table.prp_trustee_address_postal_code
               , history_table.prp_trustee_address_country
               , history_table.prp_trustee_mers_org_id
               , history_table.prp_trustee_phone_number
               , history_table.prp_fre_ctp_closing_feature_type
               , history_table.prp_fre_ctp_first_payment_due_date
               , history_table.prp_purchase_contract_date
               , history_table.prp_purchase_contract_financing_contingency_date
               , history_table.prp_purchase_contract_funding_date
               , history_table.prp_effective_property_value_type
               , history_table.prp_effective_property_value_amount
               , history_table.prp_decision_appraised_value_amount
               , history_table.prp_fha_va_reasonable_value_amount
               , history_table.prp_cd_clear_date
               , history_table.prp_disaster_declaration_check_date_type
               , history_table.prp_disaster_declaration_check_date
               , history_table.prp_any_disaster_declaration_before_appraisal
               , history_table.prp_any_disaster_declaration_after_appraisal
               , history_table.prp_any_disaster_declaration
               , history_table.prp_early_first_payment
               , history_table.prp_property_acquired_through_inheritance
               , history_table.prp_property_acquired_through_ancillary_relief
               , history_table.prp_delayed_financing_exception_guidelines_applicable
               , history_table.prp_delayed_financing_exception_verified
               , history_table.prp_effective_property_value_explanation_type
               , history_table.prp_taxes_escrowed
               , history_table.prp_flood_insurance_applicable
               , history_table.prp_windstorm_insurance_applicable
               , history_table.prp_earthquake_insurance_applicable
               , history_table.prp_arms_length
               , history_table.prp_fha_non_arms_length_ltv_exception_type
               , history_table.prp_fha_non_arms_length_ltv_exception_verified
               , history_table.prp_escrow_cushion_months
               , history_table.prp_escrow_cushion_months_auto_compute
               , history_table.prp_fha_eligible_maximum_financing
               , history_table.prp_hazard_insurance_applicable
               , history_table.prp_property_repairs_required_type
               , history_table.prp_property_repairs_description
               , history_table.prp_property_repairs_cost_amount
               , history_table.prp_property_repairs_holdback_calc_type
               , history_table.prp_property_repairs_holdback_amount
               , history_table.prp_property_repairs_holdback_payer_type
               , history_table.prp_property_repairs_holdback_administrator
               , history_table.prp_property_repairs_holdback_required_completion_date
               , history_table.prp_property_repairs_completed_notification_date
               , history_table.prp_property_repairs_inspection_ordered_date
               , history_table.prp_property_repairs_inspection_completed_date
               , history_table.prp_property_repairs_funds_released_contractor_date
               , history_table.prp_anti_steering_lowest_rate_option_rate_percent
               , history_table.prp_anti_steering_lowest_rate_option_fee_amount
               , history_table.prp_anti_steering_lowest_rate_wo_neg_option_rate_percent
               , history_table.prp_anti_steering_lowest_rate_wo_neg_option_fee_amount
               , history_table.prp_anti_steering_lowest_cost_option_rate_percent
               , history_table.prp_anti_steering_lowest_cost_option_fee_amount
               , history_table.prp_initial_uw_submit_datetime
               , history_table.prp_va_notice_of_value_source_type
               , history_table.prp_va_notice_of_value_date
               , history_table.prp_va_notice_of_value_estimated_reasonable_value_amount
               , history_table.prp_sar_significant_adjustments
               , history_table.prp_separate_transaction_for_land_acquisition
               , history_table.prp_land_acquisition_transaction_date
               , history_table.prp_land_acquisition_price
               , history_table.prp_cash_out_reason_home_improvement
               , history_table.prp_cash_out_reason_debt_or_debt_consolidation
               , history_table.prp_cash_out_reason_personal_use
               , history_table.prp_cash_out_reason_future_investment_not_under_contract
               , history_table.prp_cash_out_reason_future_investment_under_contract
               , history_table.prp_cash_out_reason_other
               , history_table.prp_cash_out_reason_other_text
               , history_table.prp_decision_veteran_borrower_pid
               , history_table.prp_signed_closing_doc_received_datetime
               , history_table.prp_other_lender_requires_appraisal
               , history_table.prp_other_lender_requires_appraisal_reason
               , history_table.prp_texas_equity_determination_datetime
               , history_table.prp_texas_equity_conversion_determination_datetime
               , history_table.prp_texas_equity_determination_datetime_override
               , history_table.prp_texas_equity_determination_datetime_override_reason
               , history_table.prp_texas_equity_conversion_determination_datetime_override
               , history_table.prp_texas_equity_conversion_determ_datetime_override_reason
               , history_table.prp_cema
               , history_table.prp_cema_borrower_savings
               , history_table.prp_any_vesting_changes
               , history_table.prp_vesting_change_titleholder_added
               , history_table.prp_vesting_change_titleholder_removed
               , history_table.prp_vesting_change_titleholder_name_change
               , history_table.prp_deed_taxes_applicable
               , history_table.prp_deed_taxes_applicable_explanation
               , history_table.prp_deed_taxes_auto_compute
               , history_table.prp_deed_taxes_auto_compute_override_reason
               , history_table.prp_intent_to_proceed_date
               , history_table.prp_intent_to_proceed_type
               , history_table.prp_intent_to_proceed_provider_unparsed_name
               , history_table.prp_intent_to_proceed_obtainer_unparsed_name
               , history_table.prp_cash_out_reason_student_loans
               , history_table.prp_household_income_exclusive_edit
               , history_table.prp_purchase_contract_received_date
               , history_table.prp_down_payment_percent_mode
               , history_table.prp_lender_escrow_loan_amount
               , history_table.prp_underwrite_disposition_note
               , history_table.prp_rescission_applicable
               , history_table.prp_area_median_income
               , history_table.prp_total_income_to_ami_ratio
               , history_table.prp_cr_tracker_url
               , history_table.prp_construction_borrower_contribution_amount
               , history_table.prp_construction_lot_ownership_status_type
               , history_table.prp_intent_to_proceed_provided
               , history_table.prp_effective_signing_location_state
               , history_table.prp_effective_signing_location_city
               , history_table.prp_va_required_guaranty_amount
               , history_table.prp_va_amount_used_to_calculate_maximum_guaranty
               , history_table.prp_va_actual_guaranty_amount
               , history_table.prp_last_corrective_disclosure_processed_datetime
               , history_table.prp_user_entered_note_date
               , history_table.prp_effective_note_date
               , history_table.prp_lender_escrow_loan_due_date
               , history_table.prp_va_maximum_base_loan_amount
               , history_table.prp_va_maximum_funding_fee_amount
               , history_table.prp_va_maximum_total_loan_amount
               , history_table.prp_va_required_cash_amount
               , history_table.prp_va_guaranty_percent
               , history_table.prp_gse_version_type
               , history_table.prp_minimum_household_income_amount
               , history_table.prp_minimum_residual_income_amount
               , history_table.prp_minimum_residual_income_auto_compute
               , history_table.prp_financed_property_improvements_category_type
               , history_table.prp_adjusted_as_is_value_amount
               , history_table.prp_after_improved_value_amount
               , history_table.prp_hud_consultant
               , history_table.prp_disclosure_action_type
               , history_table.prp_financed_property_improvements
               , history_table.prp_estimated_hard_construction_cost_amount
               , history_table.prp_initial_uw_disposition_datetime
               , history_table.prp_preapproval_complete_datetime
               , history_table.prp_preapproval_disposition_datetime
               , history_table.prp_down_payment_percent
               , history_table.prp_cash_out_reason_investment_or_business_property
               , history_table.prp_cash_out_reason_business_debt_or_debt_consolidation
               , history_table.prp_non_business_cash_out_reason_acknowledged
               , history_table.prp_va_energy_efficient_improvements_amount
               , history_table.prp_proposed_additional_monthly_payment
               , history_table.prp_term_borrower_intends_to_retain_property
               , history_table.prp_loan_modification_agreement_executed_received_datetime
               , TRUE AS data_source_deleted_flag
               , NOW( ) AS data_source_updated_datetime
          FROM (
              SELECT current_records.*
              FROM history_octane.proposal AS current_records
              LEFT JOIN history_octane.proposal AS history_records
                        ON current_records.prp_pid = history_records.prp_pid
                            AND current_records.data_source_updated_datetime < history_records.data_source_updated_datetime
              WHERE history_records.data_source_updated_datetime IS NULL
                AND current_records.data_source_deleted_flag = FALSE
          ) AS history_table
          LEFT JOIN staging_octane.proposal staging_table
                    ON staging_table.prp_pid = history_table.prp_pid
          WHERE staging_table.prp_pid IS NULL;
