name: business_income
primary_source_table: staging.staging_octane.business_income
primary_key:
- bui_pid
- bui_version
foreign_keys:
  fk_business_income_1:
    columns:
    - bui_borrower_income_pid
    references:
      columns:
      - bi_pid
      schema: history_octane
      table: borrower_income
  fkt_bui_borrower_title_type:
    columns:
    - bui_borrower_title_type
    references:
      columns:
      - code
      schema: history_octane
      table: business_income_borrower_title_type
  fkt_bui_business_disposition_type:
    columns:
    - bui_business_disposition_type
    references:
      columns:
      - code
      schema: history_octane
      table: business_disposition_type
  fkt_bui_business_income_type:
    columns:
    - bui_business_income_type
    references:
      columns:
      - code
      schema: history_octane
      table: business_income_type
  fkt_bui_calc_method_type:
    columns:
    - bui_calc_method_type
    references:
      columns:
      - code
      schema: history_octane
      table: income_history_calc_method_type
columns:
  bui_borrower_income_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_borrower_income_percent
  bui_borrower_income_pid:
    data_type: BIGINT
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_borrower_income_pid
  bui_borrower_title_other_description:
    data_type: VARCHAR(128)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_borrower_title_other_description
  bui_borrower_title_type:
    data_type: VARCHAR(128)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_borrower_title_type
  bui_business_disposition_type:
    data_type: VARCHAR(128)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_business_disposition_type
  bui_business_income_type:
    data_type: VARCHAR(128)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_business_income_type
  bui_calc_method_type:
    data_type: VARCHAR(128)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_calc_method_type
  bui_common_year1_annual_total_amount:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year1_annual_total_amount
  bui_common_year1_from_date:
    data_type: DATE
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year1_from_date
  bui_common_year1_monthly_total_amount:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year1_monthly_total_amount
  bui_common_year1_months:
    data_type: NUMERIC(4,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year1_months
  bui_common_year1_through_date:
    data_type: DATE
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year1_through_date
  bui_common_year1_year:
    data_type: INTEGER
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year1_year
  bui_common_year1_year_include:
    data_type: BOOLEAN
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year1_year_include
  bui_common_year2_annual_total_amount:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year2_annual_total_amount
  bui_common_year2_from_date:
    data_type: DATE
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year2_from_date
  bui_common_year2_monthly_total_amount:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year2_monthly_total_amount
  bui_common_year2_months:
    data_type: NUMERIC(4,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year2_months
  bui_common_year2_through_date:
    data_type: DATE
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year2_through_date
  bui_common_year2_year:
    data_type: INTEGER
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year2_year
  bui_common_year2_year_include:
    data_type: BOOLEAN
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year2_year_include
  bui_common_year3_annual_total_amount:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year3_annual_total_amount
  bui_common_year3_from_date:
    data_type: DATE
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year3_from_date
  bui_common_year3_monthly_total_amount:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year3_monthly_total_amount
  bui_common_year3_months:
    data_type: NUMERIC(4,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year3_months
  bui_common_year3_through_date:
    data_type: DATE
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year3_through_date
  bui_common_year3_year:
    data_type: INTEGER
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year3_year
  bui_common_year3_year_include:
    data_type: BOOLEAN
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_common_year3_year_include
  bui_company_ein:
    data_type: VARCHAR(16)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_company_ein
  bui_corp_year1_annual_subtotal:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_annual_subtotal
  bui_corp_year1_annual_subtotal_ownership_applied:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_annual_subtotal_ownership_applied
  bui_corp_year1_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_depletion
  bui_corp_year1_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_depreciation
  bui_corp_year1_dividends_paid_to_borrower:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_dividends_paid_to_borrower
  bui_corp_year1_domestic_production_activities:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_domestic_production_activities
  bui_corp_year1_gain_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_gain_loss
  bui_corp_year1_meals_exclusion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_meals_exclusion
  bui_corp_year1_net_operating_loss_special_deductions:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_net_operating_loss_special_deductions
  bui_corp_year1_notes_payable_less_one_year:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_notes_payable_less_one_year
  bui_corp_year1_other_deductions:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_other_deductions
  bui_corp_year1_other_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_other_income_loss
  bui_corp_year1_ownership_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_ownership_percent
  bui_corp_year1_taxable_income:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_taxable_income
  bui_corp_year1_total_tax:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year1_total_tax
  bui_corp_year2_annual_subtotal:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_annual_subtotal
  bui_corp_year2_annual_subtotal_ownership_applied:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_annual_subtotal_ownership_applied
  bui_corp_year2_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_depletion
  bui_corp_year2_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_depreciation
  bui_corp_year2_dividends_paid_to_borrower:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_dividends_paid_to_borrower
  bui_corp_year2_domestic_production_activities:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_domestic_production_activities
  bui_corp_year2_gain_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_gain_loss
  bui_corp_year2_meals_exclusion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_meals_exclusion
  bui_corp_year2_net_operating_loss_special_deductions:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_net_operating_loss_special_deductions
  bui_corp_year2_notes_payable_less_one_year:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_notes_payable_less_one_year
  bui_corp_year2_other_deductions:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_other_deductions
  bui_corp_year2_other_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_other_income_loss
  bui_corp_year2_ownership_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_ownership_percent
  bui_corp_year2_taxable_income:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_taxable_income
  bui_corp_year2_total_tax:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year2_total_tax
  bui_corp_year3_annual_subtotal:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_annual_subtotal
  bui_corp_year3_annual_subtotal_ownership_applied:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_annual_subtotal_ownership_applied
  bui_corp_year3_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_depletion
  bui_corp_year3_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_depreciation
  bui_corp_year3_dividends_paid_to_borrower:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_dividends_paid_to_borrower
  bui_corp_year3_domestic_production_activities:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_domestic_production_activities
  bui_corp_year3_gain_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_gain_loss
  bui_corp_year3_meals_exclusion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_meals_exclusion
  bui_corp_year3_net_operating_loss_special_deductions:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_net_operating_loss_special_deductions
  bui_corp_year3_notes_payable_less_one_year:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_notes_payable_less_one_year
  bui_corp_year3_other_deductions:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_other_deductions
  bui_corp_year3_other_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_other_income_loss
  bui_corp_year3_ownership_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_ownership_percent
  bui_corp_year3_taxable_income:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_taxable_income
  bui_corp_year3_total_tax:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_corp_year3_total_tax
  bui_estimated_mode:
    data_type: BOOLEAN
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_estimated_mode
  bui_estimated_net_income_amount:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_estimated_net_income_amount
  bui_form_1065_available:
    data_type: BOOLEAN
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_form_1065_available
  bui_form_1120s_available:
    data_type: BOOLEAN
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_form_1120s_available
  bui_monthly_total_amount:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_monthly_total_amount
  bui_partner_year1_amortization_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_amortization_loss
  bui_partner_year1_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_depletion
  bui_partner_year1_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_depreciation
  bui_partner_year1_form_1065_subtotal:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_form_1065_subtotal
  bui_partner_year1_form_1065_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_form_1065_total
  bui_partner_year1_form_k_1_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_form_k_1_total
  bui_partner_year1_guaranteed_payments:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_guaranteed_payments
  bui_partner_year1_meals_exclusion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_meals_exclusion
  bui_partner_year1_net_rental_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_net_rental_income_loss
  bui_partner_year1_notes_payable_less_year:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_notes_payable_less_year
  bui_partner_year1_ordinary_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_ordinary_income_loss
  bui_partner_year1_other_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_other_income_loss
  bui_partner_year1_ownership_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year1_ownership_percent
  bui_partner_year2_amortization_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_amortization_loss
  bui_partner_year2_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_depletion
  bui_partner_year2_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_depreciation
  bui_partner_year2_form_1065_subtotal:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_form_1065_subtotal
  bui_partner_year2_form_1065_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_form_1065_total
  bui_partner_year2_form_k_1_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_form_k_1_total
  bui_partner_year2_guaranteed_payments:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_guaranteed_payments
  bui_partner_year2_meals_exclusion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_meals_exclusion
  bui_partner_year2_net_rental_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_net_rental_income_loss
  bui_partner_year2_notes_payable_less_year:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_notes_payable_less_year
  bui_partner_year2_ordinary_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_ordinary_income_loss
  bui_partner_year2_other_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_other_income_loss
  bui_partner_year2_ownership_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year2_ownership_percent
  bui_partner_year3_amortization_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_amortization_loss
  bui_partner_year3_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_depletion
  bui_partner_year3_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_depreciation
  bui_partner_year3_form_1065_subtotal:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_form_1065_subtotal
  bui_partner_year3_form_1065_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_form_1065_total
  bui_partner_year3_form_k_1_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_form_k_1_total
  bui_partner_year3_guaranteed_payments:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_guaranteed_payments
  bui_partner_year3_meals_exclusion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_meals_exclusion
  bui_partner_year3_net_rental_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_net_rental_income_loss
  bui_partner_year3_notes_payable_less_year:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_notes_payable_less_year
  bui_partner_year3_ordinary_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_ordinary_income_loss
  bui_partner_year3_other_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_other_income_loss
  bui_partner_year3_ownership_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_partner_year3_ownership_percent
  bui_pid:
    data_type: BIGINT
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_pid
  bui_sch_f_year1_amortization_loss_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year1_amortization_loss_depletion
  bui_sch_f_year1_business_use_home:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year1_business_use_home
  bui_sch_f_year1_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year1_depreciation
  bui_sch_f_year1_nonrecurring_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year1_nonrecurring_income_loss
  bui_sch_f_year1_specific_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year1_specific_income_loss
  bui_sch_f_year2_amortization_loss_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year2_amortization_loss_depletion
  bui_sch_f_year2_business_use_home:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year2_business_use_home
  bui_sch_f_year2_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year2_depreciation
  bui_sch_f_year2_nonrecurring_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year2_nonrecurring_income_loss
  bui_sch_f_year2_specific_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year2_specific_income_loss
  bui_sch_f_year3_amortization_loss_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year3_amortization_loss_depletion
  bui_sch_f_year3_business_use_home:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year3_business_use_home
  bui_sch_f_year3_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year3_depreciation
  bui_sch_f_year3_nonrecurring_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year3_nonrecurring_income_loss
  bui_sch_f_year3_specific_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sch_f_year3_specific_income_loss
  bui_scorp_year1_amortization_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_amortization_loss
  bui_scorp_year1_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_depletion
  bui_scorp_year1_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_depreciation
  bui_scorp_year1_form_1120s_subtotal:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_form_1120s_subtotal
  bui_scorp_year1_form_1120s_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_form_1120s_total
  bui_scorp_year1_form_k_1_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_form_k_1_total
  bui_scorp_year1_meals_exclusion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_meals_exclusion
  bui_scorp_year1_net_rental_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_net_rental_income_loss
  bui_scorp_year1_notes_payable_less_year:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_notes_payable_less_year
  bui_scorp_year1_ordinary_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_ordinary_income_loss
  bui_scorp_year1_other_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_other_income_loss
  bui_scorp_year1_ownership_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year1_ownership_percent
  bui_scorp_year2_amortization_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_amortization_loss
  bui_scorp_year2_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_depletion
  bui_scorp_year2_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_depreciation
  bui_scorp_year2_form_1120s_subtotal:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_form_1120s_subtotal
  bui_scorp_year2_form_1120s_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_form_1120s_total
  bui_scorp_year2_form_k_1_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_form_k_1_total
  bui_scorp_year2_meals_exclusion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_meals_exclusion
  bui_scorp_year2_net_rental_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_net_rental_income_loss
  bui_scorp_year2_notes_payable_less_year:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_notes_payable_less_year
  bui_scorp_year2_ordinary_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_ordinary_income_loss
  bui_scorp_year2_other_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_other_income_loss
  bui_scorp_year2_ownership_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year2_ownership_percent
  bui_scorp_year3_amortization_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_amortization_loss
  bui_scorp_year3_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_depletion
  bui_scorp_year3_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_depreciation
  bui_scorp_year3_form_1120s_subtotal:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_form_1120s_subtotal
  bui_scorp_year3_form_1120s_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_form_1120s_total
  bui_scorp_year3_form_k_1_total:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_form_k_1_total
  bui_scorp_year3_meals_exclusion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_meals_exclusion
  bui_scorp_year3_net_rental_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_net_rental_income_loss
  bui_scorp_year3_notes_payable_less_year:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_notes_payable_less_year
  bui_scorp_year3_ordinary_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_ordinary_income_loss
  bui_scorp_year3_other_income_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_other_income_loss
  bui_scorp_year3_ownership_percent:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_scorp_year3_ownership_percent
  bui_sole_year1_amortization_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_amortization_loss
  bui_sole_year1_business_miles:
    data_type: INTEGER
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_business_miles
  bui_sole_year1_business_use_home:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_business_use_home
  bui_sole_year1_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_depletion
  bui_sole_year1_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_depreciation
  bui_sole_year1_depreciation_mile:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_depreciation_mile
  bui_sole_year1_gross_receipts:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_gross_receipts
  bui_sole_year1_meal_exclusions:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_meal_exclusions
  bui_sole_year1_mileage_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_mileage_depreciation
  bui_sole_year1_other_income_loss_exp:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year1_other_income_loss_exp
  bui_sole_year2_amortization_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_amortization_loss
  bui_sole_year2_business_miles:
    data_type: INTEGER
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_business_miles
  bui_sole_year2_business_use_home:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_business_use_home
  bui_sole_year2_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_depletion
  bui_sole_year2_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_depreciation
  bui_sole_year2_depreciation_mile:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_depreciation_mile
  bui_sole_year2_gross_receipts:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_gross_receipts
  bui_sole_year2_meal_exclusions:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_meal_exclusions
  bui_sole_year2_mileage_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_mileage_depreciation
  bui_sole_year2_other_income_loss_exp:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year2_other_income_loss_exp
  bui_sole_year3_amortization_loss:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_amortization_loss
  bui_sole_year3_business_miles:
    data_type: INTEGER
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_business_miles
  bui_sole_year3_business_use_home:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_business_use_home
  bui_sole_year3_depletion:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_depletion
  bui_sole_year3_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_depreciation
  bui_sole_year3_depreciation_mile:
    data_type: NUMERIC(11,9)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_depreciation_mile
  bui_sole_year3_gross_receipts:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_gross_receipts
  bui_sole_year3_meal_exclusions:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_meal_exclusions
  bui_sole_year3_mileage_depreciation:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_mileage_depreciation
  bui_sole_year3_other_income_loss_exp:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_sole_year3_other_income_loss_exp
  bui_underwriter_comments:
    data_type: VARCHAR(1024)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_underwriter_comments
  bui_version:
    data_type: INTEGER
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_version
  bui_worksheet_monthly_total_amount:
    data_type: NUMERIC(15,2)
    physical_column_flag: true
    source:
      field: primary_source_table.columns.bui_worksheet_monthly_total_amount
  data_source_deleted_flag:
    data_type: BOOLEAN
    physical_column_flag: true
  data_source_updated_datetime:
    data_type: TIMESTAMPTZ
    physical_column_flag: true
  etl_batch_id:
    data_type: TEXT
    physical_column_flag: true
step_functions:
  SP-100130:
    etls:
      ETL-100130:
        input_type: table
        output_type: insert
        output_table: staging.history_octane.business_income
        json_output_field: bui_pid
        truncate_table: false
        container_memory: 4096
        input_sql: |-
          --finding records to insert into history_octane.business_income
          SELECT staging_table.bui_pid
               , staging_table.bui_version
               , staging_table.bui_borrower_income_pid
               , staging_table.bui_business_income_type
               , staging_table.bui_business_disposition_type
               , staging_table.bui_company_ein
               , staging_table.bui_estimated_net_income_amount
               , staging_table.bui_estimated_mode
               , staging_table.bui_worksheet_monthly_total_amount
               , staging_table.bui_monthly_total_amount
               , staging_table.bui_borrower_income_percent
               , staging_table.bui_calc_method_type
               , staging_table.bui_common_year1_year
               , staging_table.bui_common_year1_year_include
               , staging_table.bui_common_year1_from_date
               , staging_table.bui_common_year1_through_date
               , staging_table.bui_common_year1_months
               , staging_table.bui_common_year1_annual_total_amount
               , staging_table.bui_common_year1_monthly_total_amount
               , staging_table.bui_common_year2_year
               , staging_table.bui_common_year2_year_include
               , staging_table.bui_common_year2_from_date
               , staging_table.bui_common_year2_through_date
               , staging_table.bui_common_year2_months
               , staging_table.bui_common_year2_annual_total_amount
               , staging_table.bui_common_year2_monthly_total_amount
               , staging_table.bui_common_year3_year
               , staging_table.bui_common_year3_year_include
               , staging_table.bui_common_year3_from_date
               , staging_table.bui_common_year3_through_date
               , staging_table.bui_common_year3_months
               , staging_table.bui_common_year3_annual_total_amount
               , staging_table.bui_common_year3_monthly_total_amount
               , staging_table.bui_sole_year1_gross_receipts
               , staging_table.bui_sole_year1_other_income_loss_exp
               , staging_table.bui_sole_year1_depletion
               , staging_table.bui_sole_year1_depreciation
               , staging_table.bui_sole_year1_meal_exclusions
               , staging_table.bui_sole_year1_business_use_home
               , staging_table.bui_sole_year1_amortization_loss
               , staging_table.bui_sole_year1_business_miles
               , staging_table.bui_sole_year1_depreciation_mile
               , staging_table.bui_sole_year1_mileage_depreciation
               , staging_table.bui_sole_year2_gross_receipts
               , staging_table.bui_sole_year2_other_income_loss_exp
               , staging_table.bui_sole_year2_depletion
               , staging_table.bui_sole_year2_depreciation
               , staging_table.bui_sole_year2_meal_exclusions
               , staging_table.bui_sole_year2_business_use_home
               , staging_table.bui_sole_year2_amortization_loss
               , staging_table.bui_sole_year2_business_miles
               , staging_table.bui_sole_year2_depreciation_mile
               , staging_table.bui_sole_year2_mileage_depreciation
               , staging_table.bui_sole_year3_gross_receipts
               , staging_table.bui_sole_year3_other_income_loss_exp
               , staging_table.bui_sole_year3_depletion
               , staging_table.bui_sole_year3_depreciation
               , staging_table.bui_sole_year3_meal_exclusions
               , staging_table.bui_sole_year3_business_use_home
               , staging_table.bui_sole_year3_amortization_loss
               , staging_table.bui_sole_year3_business_miles
               , staging_table.bui_sole_year3_depreciation_mile
               , staging_table.bui_sole_year3_mileage_depreciation
               , staging_table.bui_partner_year1_amortization_loss
               , staging_table.bui_partner_year1_depletion
               , staging_table.bui_partner_year1_depreciation
               , staging_table.bui_partner_year1_guaranteed_payments
               , staging_table.bui_partner_year1_meals_exclusion
               , staging_table.bui_partner_year1_net_rental_income_loss
               , staging_table.bui_partner_year1_notes_payable_less_year
               , staging_table.bui_partner_year1_ordinary_income_loss
               , staging_table.bui_partner_year1_other_income_loss
               , staging_table.bui_partner_year1_ownership_percent
               , staging_table.bui_partner_year1_form_k_1_total
               , staging_table.bui_partner_year1_form_1065_subtotal
               , staging_table.bui_partner_year1_form_1065_total
               , staging_table.bui_partner_year2_amortization_loss
               , staging_table.bui_partner_year2_depletion
               , staging_table.bui_partner_year2_depreciation
               , staging_table.bui_partner_year2_guaranteed_payments
               , staging_table.bui_partner_year2_meals_exclusion
               , staging_table.bui_partner_year2_net_rental_income_loss
               , staging_table.bui_partner_year2_notes_payable_less_year
               , staging_table.bui_partner_year2_ordinary_income_loss
               , staging_table.bui_partner_year2_other_income_loss
               , staging_table.bui_partner_year2_ownership_percent
               , staging_table.bui_partner_year2_form_k_1_total
               , staging_table.bui_partner_year2_form_1065_subtotal
               , staging_table.bui_partner_year2_form_1065_total
               , staging_table.bui_partner_year3_amortization_loss
               , staging_table.bui_partner_year3_depletion
               , staging_table.bui_partner_year3_depreciation
               , staging_table.bui_partner_year3_guaranteed_payments
               , staging_table.bui_partner_year3_meals_exclusion
               , staging_table.bui_partner_year3_net_rental_income_loss
               , staging_table.bui_partner_year3_notes_payable_less_year
               , staging_table.bui_partner_year3_ordinary_income_loss
               , staging_table.bui_partner_year3_other_income_loss
               , staging_table.bui_partner_year3_ownership_percent
               , staging_table.bui_partner_year3_form_k_1_total
               , staging_table.bui_partner_year3_form_1065_subtotal
               , staging_table.bui_partner_year3_form_1065_total
               , staging_table.bui_form_1065_available
               , staging_table.bui_scorp_year1_ordinary_income_loss
               , staging_table.bui_scorp_year1_net_rental_income_loss
               , staging_table.bui_scorp_year1_other_income_loss
               , staging_table.bui_scorp_year1_depletion
               , staging_table.bui_scorp_year1_depreciation
               , staging_table.bui_scorp_year1_amortization_loss
               , staging_table.bui_scorp_year1_notes_payable_less_year
               , staging_table.bui_scorp_year1_meals_exclusion
               , staging_table.bui_scorp_year1_ownership_percent
               , staging_table.bui_scorp_year1_form_k_1_total
               , staging_table.bui_scorp_year1_form_1120s_subtotal
               , staging_table.bui_scorp_year1_form_1120s_total
               , staging_table.bui_scorp_year2_ordinary_income_loss
               , staging_table.bui_scorp_year2_net_rental_income_loss
               , staging_table.bui_scorp_year2_other_income_loss
               , staging_table.bui_scorp_year2_depletion
               , staging_table.bui_scorp_year2_depreciation
               , staging_table.bui_scorp_year2_amortization_loss
               , staging_table.bui_scorp_year2_notes_payable_less_year
               , staging_table.bui_scorp_year2_meals_exclusion
               , staging_table.bui_scorp_year2_ownership_percent
               , staging_table.bui_scorp_year2_form_k_1_total
               , staging_table.bui_scorp_year2_form_1120s_subtotal
               , staging_table.bui_scorp_year2_form_1120s_total
               , staging_table.bui_scorp_year3_ordinary_income_loss
               , staging_table.bui_scorp_year3_net_rental_income_loss
               , staging_table.bui_scorp_year3_other_income_loss
               , staging_table.bui_scorp_year3_depletion
               , staging_table.bui_scorp_year3_depreciation
               , staging_table.bui_scorp_year3_amortization_loss
               , staging_table.bui_scorp_year3_notes_payable_less_year
               , staging_table.bui_scorp_year3_meals_exclusion
               , staging_table.bui_scorp_year3_ownership_percent
               , staging_table.bui_scorp_year3_form_k_1_total
               , staging_table.bui_scorp_year3_form_1120s_subtotal
               , staging_table.bui_scorp_year3_form_1120s_total
               , staging_table.bui_form_1120s_available
               , staging_table.bui_corp_year1_taxable_income
               , staging_table.bui_corp_year1_total_tax
               , staging_table.bui_corp_year1_gain_loss
               , staging_table.bui_corp_year1_other_income_loss
               , staging_table.bui_corp_year1_depreciation
               , staging_table.bui_corp_year1_depletion
               , staging_table.bui_corp_year1_domestic_production_activities
               , staging_table.bui_corp_year1_other_deductions
               , staging_table.bui_corp_year1_net_operating_loss_special_deductions
               , staging_table.bui_corp_year1_notes_payable_less_one_year
               , staging_table.bui_corp_year1_meals_exclusion
               , staging_table.bui_corp_year1_dividends_paid_to_borrower
               , staging_table.bui_corp_year1_annual_subtotal
               , staging_table.bui_corp_year1_ownership_percent
               , staging_table.bui_corp_year1_annual_subtotal_ownership_applied
               , staging_table.bui_corp_year2_taxable_income
               , staging_table.bui_corp_year2_total_tax
               , staging_table.bui_corp_year2_gain_loss
               , staging_table.bui_corp_year2_other_income_loss
               , staging_table.bui_corp_year2_depreciation
               , staging_table.bui_corp_year2_depletion
               , staging_table.bui_corp_year2_domestic_production_activities
               , staging_table.bui_corp_year2_other_deductions
               , staging_table.bui_corp_year2_net_operating_loss_special_deductions
               , staging_table.bui_corp_year2_notes_payable_less_one_year
               , staging_table.bui_corp_year2_meals_exclusion
               , staging_table.bui_corp_year2_dividends_paid_to_borrower
               , staging_table.bui_corp_year2_annual_subtotal
               , staging_table.bui_corp_year2_ownership_percent
               , staging_table.bui_corp_year2_annual_subtotal_ownership_applied
               , staging_table.bui_corp_year3_taxable_income
               , staging_table.bui_corp_year3_total_tax
               , staging_table.bui_corp_year3_gain_loss
               , staging_table.bui_corp_year3_other_income_loss
               , staging_table.bui_corp_year3_depreciation
               , staging_table.bui_corp_year3_depletion
               , staging_table.bui_corp_year3_domestic_production_activities
               , staging_table.bui_corp_year3_other_deductions
               , staging_table.bui_corp_year3_net_operating_loss_special_deductions
               , staging_table.bui_corp_year3_notes_payable_less_one_year
               , staging_table.bui_corp_year3_meals_exclusion
               , staging_table.bui_corp_year3_dividends_paid_to_borrower
               , staging_table.bui_corp_year3_annual_subtotal
               , staging_table.bui_corp_year3_ownership_percent
               , staging_table.bui_corp_year3_annual_subtotal_ownership_applied
               , staging_table.bui_sch_f_year1_specific_income_loss
               , staging_table.bui_sch_f_year1_nonrecurring_income_loss
               , staging_table.bui_sch_f_year1_depreciation
               , staging_table.bui_sch_f_year1_amortization_loss_depletion
               , staging_table.bui_sch_f_year1_business_use_home
               , staging_table.bui_sch_f_year2_specific_income_loss
               , staging_table.bui_sch_f_year2_nonrecurring_income_loss
               , staging_table.bui_sch_f_year2_depreciation
               , staging_table.bui_sch_f_year2_amortization_loss_depletion
               , staging_table.bui_sch_f_year2_business_use_home
               , staging_table.bui_sch_f_year3_specific_income_loss
               , staging_table.bui_sch_f_year3_nonrecurring_income_loss
               , staging_table.bui_sch_f_year3_depreciation
               , staging_table.bui_sch_f_year3_amortization_loss_depletion
               , staging_table.bui_sch_f_year3_business_use_home
               , staging_table.bui_underwriter_comments
               , staging_table.bui_borrower_title_type
               , staging_table.bui_borrower_title_other_description
               , FALSE AS data_source_deleted_flag
               , NOW( ) AS data_source_updated_datetime
          FROM staging_octane.business_income staging_table
          LEFT JOIN history_octane.business_income history_table
                    ON staging_table.bui_pid = history_table.bui_pid
                        AND staging_table.bui_version = history_table.bui_version
          WHERE history_table.bui_pid IS NULL
          UNION ALL
          SELECT history_table.bui_pid
               , history_table.bui_version + 1
               , history_table.bui_borrower_income_pid
               , history_table.bui_business_income_type
               , history_table.bui_business_disposition_type
               , history_table.bui_company_ein
               , history_table.bui_estimated_net_income_amount
               , history_table.bui_estimated_mode
               , history_table.bui_worksheet_monthly_total_amount
               , history_table.bui_monthly_total_amount
               , history_table.bui_borrower_income_percent
               , history_table.bui_calc_method_type
               , history_table.bui_common_year1_year
               , history_table.bui_common_year1_year_include
               , history_table.bui_common_year1_from_date
               , history_table.bui_common_year1_through_date
               , history_table.bui_common_year1_months
               , history_table.bui_common_year1_annual_total_amount
               , history_table.bui_common_year1_monthly_total_amount
               , history_table.bui_common_year2_year
               , history_table.bui_common_year2_year_include
               , history_table.bui_common_year2_from_date
               , history_table.bui_common_year2_through_date
               , history_table.bui_common_year2_months
               , history_table.bui_common_year2_annual_total_amount
               , history_table.bui_common_year2_monthly_total_amount
               , history_table.bui_common_year3_year
               , history_table.bui_common_year3_year_include
               , history_table.bui_common_year3_from_date
               , history_table.bui_common_year3_through_date
               , history_table.bui_common_year3_months
               , history_table.bui_common_year3_annual_total_amount
               , history_table.bui_common_year3_monthly_total_amount
               , history_table.bui_sole_year1_gross_receipts
               , history_table.bui_sole_year1_other_income_loss_exp
               , history_table.bui_sole_year1_depletion
               , history_table.bui_sole_year1_depreciation
               , history_table.bui_sole_year1_meal_exclusions
               , history_table.bui_sole_year1_business_use_home
               , history_table.bui_sole_year1_amortization_loss
               , history_table.bui_sole_year1_business_miles
               , history_table.bui_sole_year1_depreciation_mile
               , history_table.bui_sole_year1_mileage_depreciation
               , history_table.bui_sole_year2_gross_receipts
               , history_table.bui_sole_year2_other_income_loss_exp
               , history_table.bui_sole_year2_depletion
               , history_table.bui_sole_year2_depreciation
               , history_table.bui_sole_year2_meal_exclusions
               , history_table.bui_sole_year2_business_use_home
               , history_table.bui_sole_year2_amortization_loss
               , history_table.bui_sole_year2_business_miles
               , history_table.bui_sole_year2_depreciation_mile
               , history_table.bui_sole_year2_mileage_depreciation
               , history_table.bui_sole_year3_gross_receipts
               , history_table.bui_sole_year3_other_income_loss_exp
               , history_table.bui_sole_year3_depletion
               , history_table.bui_sole_year3_depreciation
               , history_table.bui_sole_year3_meal_exclusions
               , history_table.bui_sole_year3_business_use_home
               , history_table.bui_sole_year3_amortization_loss
               , history_table.bui_sole_year3_business_miles
               , history_table.bui_sole_year3_depreciation_mile
               , history_table.bui_sole_year3_mileage_depreciation
               , history_table.bui_partner_year1_amortization_loss
               , history_table.bui_partner_year1_depletion
               , history_table.bui_partner_year1_depreciation
               , history_table.bui_partner_year1_guaranteed_payments
               , history_table.bui_partner_year1_meals_exclusion
               , history_table.bui_partner_year1_net_rental_income_loss
               , history_table.bui_partner_year1_notes_payable_less_year
               , history_table.bui_partner_year1_ordinary_income_loss
               , history_table.bui_partner_year1_other_income_loss
               , history_table.bui_partner_year1_ownership_percent
               , history_table.bui_partner_year1_form_k_1_total
               , history_table.bui_partner_year1_form_1065_subtotal
               , history_table.bui_partner_year1_form_1065_total
               , history_table.bui_partner_year2_amortization_loss
               , history_table.bui_partner_year2_depletion
               , history_table.bui_partner_year2_depreciation
               , history_table.bui_partner_year2_guaranteed_payments
               , history_table.bui_partner_year2_meals_exclusion
               , history_table.bui_partner_year2_net_rental_income_loss
               , history_table.bui_partner_year2_notes_payable_less_year
               , history_table.bui_partner_year2_ordinary_income_loss
               , history_table.bui_partner_year2_other_income_loss
               , history_table.bui_partner_year2_ownership_percent
               , history_table.bui_partner_year2_form_k_1_total
               , history_table.bui_partner_year2_form_1065_subtotal
               , history_table.bui_partner_year2_form_1065_total
               , history_table.bui_partner_year3_amortization_loss
               , history_table.bui_partner_year3_depletion
               , history_table.bui_partner_year3_depreciation
               , history_table.bui_partner_year3_guaranteed_payments
               , history_table.bui_partner_year3_meals_exclusion
               , history_table.bui_partner_year3_net_rental_income_loss
               , history_table.bui_partner_year3_notes_payable_less_year
               , history_table.bui_partner_year3_ordinary_income_loss
               , history_table.bui_partner_year3_other_income_loss
               , history_table.bui_partner_year3_ownership_percent
               , history_table.bui_partner_year3_form_k_1_total
               , history_table.bui_partner_year3_form_1065_subtotal
               , history_table.bui_partner_year3_form_1065_total
               , history_table.bui_form_1065_available
               , history_table.bui_scorp_year1_ordinary_income_loss
               , history_table.bui_scorp_year1_net_rental_income_loss
               , history_table.bui_scorp_year1_other_income_loss
               , history_table.bui_scorp_year1_depletion
               , history_table.bui_scorp_year1_depreciation
               , history_table.bui_scorp_year1_amortization_loss
               , history_table.bui_scorp_year1_notes_payable_less_year
               , history_table.bui_scorp_year1_meals_exclusion
               , history_table.bui_scorp_year1_ownership_percent
               , history_table.bui_scorp_year1_form_k_1_total
               , history_table.bui_scorp_year1_form_1120s_subtotal
               , history_table.bui_scorp_year1_form_1120s_total
               , history_table.bui_scorp_year2_ordinary_income_loss
               , history_table.bui_scorp_year2_net_rental_income_loss
               , history_table.bui_scorp_year2_other_income_loss
               , history_table.bui_scorp_year2_depletion
               , history_table.bui_scorp_year2_depreciation
               , history_table.bui_scorp_year2_amortization_loss
               , history_table.bui_scorp_year2_notes_payable_less_year
               , history_table.bui_scorp_year2_meals_exclusion
               , history_table.bui_scorp_year2_ownership_percent
               , history_table.bui_scorp_year2_form_k_1_total
               , history_table.bui_scorp_year2_form_1120s_subtotal
               , history_table.bui_scorp_year2_form_1120s_total
               , history_table.bui_scorp_year3_ordinary_income_loss
               , history_table.bui_scorp_year3_net_rental_income_loss
               , history_table.bui_scorp_year3_other_income_loss
               , history_table.bui_scorp_year3_depletion
               , history_table.bui_scorp_year3_depreciation
               , history_table.bui_scorp_year3_amortization_loss
               , history_table.bui_scorp_year3_notes_payable_less_year
               , history_table.bui_scorp_year3_meals_exclusion
               , history_table.bui_scorp_year3_ownership_percent
               , history_table.bui_scorp_year3_form_k_1_total
               , history_table.bui_scorp_year3_form_1120s_subtotal
               , history_table.bui_scorp_year3_form_1120s_total
               , history_table.bui_form_1120s_available
               , history_table.bui_corp_year1_taxable_income
               , history_table.bui_corp_year1_total_tax
               , history_table.bui_corp_year1_gain_loss
               , history_table.bui_corp_year1_other_income_loss
               , history_table.bui_corp_year1_depreciation
               , history_table.bui_corp_year1_depletion
               , history_table.bui_corp_year1_domestic_production_activities
               , history_table.bui_corp_year1_other_deductions
               , history_table.bui_corp_year1_net_operating_loss_special_deductions
               , history_table.bui_corp_year1_notes_payable_less_one_year
               , history_table.bui_corp_year1_meals_exclusion
               , history_table.bui_corp_year1_dividends_paid_to_borrower
               , history_table.bui_corp_year1_annual_subtotal
               , history_table.bui_corp_year1_ownership_percent
               , history_table.bui_corp_year1_annual_subtotal_ownership_applied
               , history_table.bui_corp_year2_taxable_income
               , history_table.bui_corp_year2_total_tax
               , history_table.bui_corp_year2_gain_loss
               , history_table.bui_corp_year2_other_income_loss
               , history_table.bui_corp_year2_depreciation
               , history_table.bui_corp_year2_depletion
               , history_table.bui_corp_year2_domestic_production_activities
               , history_table.bui_corp_year2_other_deductions
               , history_table.bui_corp_year2_net_operating_loss_special_deductions
               , history_table.bui_corp_year2_notes_payable_less_one_year
               , history_table.bui_corp_year2_meals_exclusion
               , history_table.bui_corp_year2_dividends_paid_to_borrower
               , history_table.bui_corp_year2_annual_subtotal
               , history_table.bui_corp_year2_ownership_percent
               , history_table.bui_corp_year2_annual_subtotal_ownership_applied
               , history_table.bui_corp_year3_taxable_income
               , history_table.bui_corp_year3_total_tax
               , history_table.bui_corp_year3_gain_loss
               , history_table.bui_corp_year3_other_income_loss
               , history_table.bui_corp_year3_depreciation
               , history_table.bui_corp_year3_depletion
               , history_table.bui_corp_year3_domestic_production_activities
               , history_table.bui_corp_year3_other_deductions
               , history_table.bui_corp_year3_net_operating_loss_special_deductions
               , history_table.bui_corp_year3_notes_payable_less_one_year
               , history_table.bui_corp_year3_meals_exclusion
               , history_table.bui_corp_year3_dividends_paid_to_borrower
               , history_table.bui_corp_year3_annual_subtotal
               , history_table.bui_corp_year3_ownership_percent
               , history_table.bui_corp_year3_annual_subtotal_ownership_applied
               , history_table.bui_sch_f_year1_specific_income_loss
               , history_table.bui_sch_f_year1_nonrecurring_income_loss
               , history_table.bui_sch_f_year1_depreciation
               , history_table.bui_sch_f_year1_amortization_loss_depletion
               , history_table.bui_sch_f_year1_business_use_home
               , history_table.bui_sch_f_year2_specific_income_loss
               , history_table.bui_sch_f_year2_nonrecurring_income_loss
               , history_table.bui_sch_f_year2_depreciation
               , history_table.bui_sch_f_year2_amortization_loss_depletion
               , history_table.bui_sch_f_year2_business_use_home
               , history_table.bui_sch_f_year3_specific_income_loss
               , history_table.bui_sch_f_year3_nonrecurring_income_loss
               , history_table.bui_sch_f_year3_depreciation
               , history_table.bui_sch_f_year3_amortization_loss_depletion
               , history_table.bui_sch_f_year3_business_use_home
               , history_table.bui_underwriter_comments
               , history_table.bui_borrower_title_type
               , history_table.bui_borrower_title_other_description
               , TRUE AS data_source_deleted_flag
               , NOW( ) AS data_source_updated_datetime
          FROM (
              SELECT current_records.*
              FROM history_octane.business_income AS current_records
              LEFT JOIN history_octane.business_income AS history_records
                        ON current_records.bui_pid = history_records.bui_pid
                            AND current_records.data_source_updated_datetime < history_records.data_source_updated_datetime
              WHERE history_records.data_source_updated_datetime IS NULL
                AND current_records.data_source_deleted_flag = FALSE
          ) AS history_table
          LEFT JOIN staging_octane.business_income staging_table
                    ON staging_table.bui_pid = history_table.bui_pid
          WHERE staging_table.bui_pid IS NULL;
