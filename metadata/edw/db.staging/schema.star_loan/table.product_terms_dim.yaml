name: product_terms_dim
primary_source_table: staging.history_octane.product_terms
primary_key:
- dwid
columns:
  dwid:
    data_type: BIGINT
    update_flag: false
  data_source_dwid:
    data_type: BIGINT
    update_flag: true
  edw_created_datetime:
    data_type: TIMESTAMPTZ
    update_flag: false
  edw_modified_datetime:
    data_type: TIMESTAMPTZ
    update_flag: true
  etl_batch_id:
    data_type: TEXT
    update_flag: true
  data_source_integration_columns:
    data_type: TEXT
    update_flag: true
  data_source_integration_id:
    data_type: TEXT
    update_flag: false
  data_source_modified_datetime:
    data_type: TIMESTAMPTZ
    update_flag: false
  product_terms_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.pt_pid
    update_flag: true
  product_pid:
    data_type: BIGINT
    source:
      field: primary_source_table.columns.pt_product_pid
    update_flag: true
  amortization_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_amortization_term_months
    update_flag: true
  arm_convertible_from_month:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_arm_convertible_from_month
    update_flag: true
  arm_convertible_through_month:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_arm_convertible_through_month
    update_flag: true
  arm_floor_rate_percent:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_arm_floor_rate_percent
    update_flag: true
  arm_index:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_arm_index_type.columns.value
    update_flag: true
  arm_index_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_arm_index_type
    update_flag: true
  arm_lookback_period_days:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_arm_lookback_period_days
    update_flag: true
  arm_payment_adjustment_calculation:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_arm_payment_adjustment_calculation_type.columns.value
    update_flag: true
  arm_payment_adjustment_calculation_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_arm_payment_adjustment_calculation_type
    update_flag: true
  buydown_base_date:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_buydown_base_date_type.columns.value
    update_flag: true
  buydown_base_date_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_buydown_base_date_type
    update_flag: true
  buydown_subsidy_calculation_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_buydown_subsidy_calculation_type
    update_flag: true
  buydown_subsidy_calculation:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_buydown_subsidy_calculation_type.columns.value
    update_flag: true
  community_lending:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_community_lending_type.columns.value
    update_flag: true
  community_lending_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_community_lending_type
    update_flag: true
  days_per_year:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_days_per_year_type.columns.value
    update_flag: true
  days_per_year_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_days_per_year_type
    update_flag: true
  decision_credit_score_calc:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_decision_credit_score_calc_type.columns.value
    update_flag: true
  decision_credit_score_calc_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_decision_credit_score_calc_type
    update_flag: true
  deed_page_count:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_deed_page_count
    update_flag: true
  deferred_payment_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_deferred_payment_months
    update_flag: true
  dsi_plan_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_dsi_plan_code
    update_flag: true
  due_in_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_due_in_term_months
    update_flag: true
  escrow_cushion_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_escrow_cushion_months
    update_flag: true
  fha_rehab_program:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_fha_rehab_program_type.columns.value
    update_flag: true
  fha_rehab_program_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fha_rehab_program_type
    update_flag: true
  fha_special_program:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_fha_special_program_type.columns.value
    update_flag: true
  fha_special_program_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fha_special_program_type
    update_flag: true
  fnm_arm_plan:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_fnm_arm_plan_type.columns.value
    update_flag: true
  fnm_arm_plan_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fnm_arm_plan_type
    update_flag: true
  fnm_community_lending_product:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_fnm_community_lending_product_type.columns.value
    update_flag: true
  fnm_community_lending_product_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fnm_community_lending_product_type
    update_flag: true
  fre_community_program:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_fre_community_program_type.columns.value
    update_flag: true
  fre_community_program_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_fre_community_program_type
    update_flag: true
  from_date:
    data_type: DATE
    source:
      field: primary_source_table.columns.pt_from_date
    update_flag: true
  gpm_adjustment_percent:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_gpm_adjustment_percent
    update_flag: true
  gpm_adjustment_years:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_gpm_adjustment_years
    update_flag: true
  conditions_to_assumability_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_conditions_to_assumability
    update_flag: true
  demand_feature_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_demand_feature
    update_flag: true
  lender_hazard_insurance_available_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_lender_hazard_insurance_available
    update_flag: true
  prepayment_charge_refund_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_prepayment_finance_charge_refund
    update_flag: true
  heloc_cancel_fee_amount:
    data_type: NUMERIC(21,3)
    source:
      field: primary_source_table.columns.pt_heloc_cancel_fee_amount
    update_flag: true
  heloc_cancel_fee_applicable:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_heloc_cancel_fee_applicable_type.columns.value
    update_flag: true
  heloc_cancel_fee_applicable_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_heloc_cancel_fee_applicable_type
    update_flag: true
  heloc_cancel_fee_period_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_heloc_cancel_fee_period_months
    update_flag: true
  heloc_draw_period_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_heloc_draw_period_months
    update_flag: true
  heloc_maximum_initial_draw_amount:
    data_type: NUMERIC(21,3)
    source:
      field: primary_source_table.columns.pt_heloc_maximum_initial_draw_amount
    update_flag: true
  heloc_minimum_draw_amount:
    data_type: NUMERIC(21,3)
    source:
      field: primary_source_table.columns.pt_heloc_minimum_draw_amount
    update_flag: true
  heloc_repayment_period_duration_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_heloc_repayment_period_duration_months
    update_flag: true
  high_balance:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_high_balance_temp.columns.value
    update_flag: true
  high_balance_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_high_balance
    update_flag: true
  initial_payment_adjustment_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_initial_payment_adjustment_term_months
    update_flag: true
  initial_rate_adjustment_cap_percent:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_initial_rate_adjustment_cap_percent
    update_flag: true
  initial_rate_adjustment_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_initial_rate_adjustment_term_months
    update_flag: true
  ipc_calc:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_ipc_calc_type.columns.value
    update_flag: true
  ipc_calc_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_calc_type
    update_flag: true
  ipc_cltv_ratio_percent1:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_ipc_cltv_ratio_percent1
    update_flag: true
  ipc_cltv_ratio_percent2:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_ipc_cltv_ratio_percent2
    update_flag: true
  ipc_cltv_ratio_percent3:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_ipc_cltv_ratio_percent3
    update_flag: true
  ipc_cltv_ratio_percent4:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_ipc_cltv_ratio_percent4
    update_flag: true
  ipc_comparison_operator_code1:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_comparison_operator_type1
    update_flag: true
  ipc_comparison_operator_code2:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_comparison_operator_type2
    update_flag: true
  ipc_comparison_operator_code3:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_comparison_operator_type3
    update_flag: true
  ipc_comparison_operator_code4:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_comparison_operator_type4
    update_flag: true
  ipc_comparison_operator1:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_ipc_comparison_operator_type1.columns.value
    update_flag: true
  ipc_comparison_operator2:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_ipc_comparison_operator_type2.columns.value
    update_flag: true
  ipc_comparison_operator3:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_ipc_comparison_operator_type3.columns.value
    update_flag: true
  ipc_comparison_operator4:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_ipc_comparison_operator_type4.columns.value
    update_flag: true
  ipc_limit_percent1:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_ipc_limit_percent1
    update_flag: true
  ipc_limit_percent2:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_ipc_limit_percent2
    update_flag: true
  ipc_limit_percent3:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_ipc_limit_percent3
    update_flag: true
  ipc_limit_percent4:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_ipc_limit_percent4
    update_flag: true
  ipc_property_usage_code1:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_property_usage_type1
    update_flag: true
  ipc_property_usage_code2:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_property_usage_type2
    update_flag: true
  ipc_property_usage_code3:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_property_usage_type3
    update_flag: true
  ipc_property_usage_code4:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_ipc_property_usage_type4
    update_flag: true
  ipc_property_usage1:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_ipc_property_usage_type1.columns.value
    update_flag: true
  ipc_property_usage2:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_ipc_property_usage_type2.columns.value
    update_flag: true
  ipc_property_usage3:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_ipc_property_usage_type3.columns.value
    update_flag: true
  ipc_property_usage4:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_ipc_property_usage_type4.columns.value
    update_flag: true
  allow_loan_amount_cents_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_allow_loan_amount_cents
    update_flag: true
  always_current_market_price_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_always_current_market_price
    update_flag: true
  arm_convertible_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_arm_convertible
    update_flag: true
  assumable_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_assumable
    update_flag: true
  credit_qualifying_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_credit_qualifying
    update_flag: true
  du_risk_assessment_accepted_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_du_risk_assessment_accepted
    update_flag: true
  escrow_waiver_allowed_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_escrow_waiver_allowed
    update_flag: true
  external_fha_underwrite_accepted_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_external_fha_underwrite_accepted
    update_flag: true
  external_investor_underwrite_accepted_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_external_investor_underwrite_accepted
    update_flag: true
  external_usda_underwrite_accepted_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_external_usda_underwrite_accepted
    update_flag: true
  external_va_underwrite_accepted_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_external_va_underwrite_accepted
    update_flag: true
  family_advantage_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_family_advantage
    update_flag: true
  heloc_maximum_initial_draw_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_heloc_maximum_initial_draw
    update_flag: true
  heloc_minimum_draw_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_heloc_minimum_draw
    update_flag: true
  internal_underwrite_accepted_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_internal_underwrite_accepted
    update_flag: true
  loan_requires_hazard_insurance_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_loan_requires_hazard_insurance
    update_flag: true
  lp_risk_assessment_accepted_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_lp_risk_assessment_accepted
    update_flag: true
  manual_risk_assessment_accepted_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_manual_risk_assessment_accepted
    update_flag: true
  mortgage_credit_certificate_eligible_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_mortgage_credit_certificate_eligible
    update_flag: true
  new_york_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_new_york
    update_flag: true
  no_mi_product_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_no_mi_product
    update_flag: true
  non_conforming_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_non_conforming
    update_flag: true
  rate_protect_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_rate_protect
    update_flag: true
  texas_veterans_land_board:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_texas_veterans_land_board.columns.value
    update_flag: true
  texas_veterans_land_board_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_texas_veterans_land_board
    update_flag: true
  third_party_grant_eligible_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_third_party_grant_eligible
    update_flag: true
  zero_note_rate_flag:
    data_type: BOOLEAN
    source:
      field: primary_source_table.columns.pt_zero_note_rate
    update_flag: true
  lender_hazard_insurance_premium_amount:
    data_type: NUMERIC(21,3)
    source:
      field: primary_source_table.columns.pt_lender_hazard_insurance_premium_amount
    update_flag: true
  lender_hazard_insurance_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_lender_hazard_insurance_term_months
    update_flag: true
  lien_priority:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_lien_priority_type.columns.value
    update_flag: true
  lien_priority_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_lien_priority_type
    update_flag: true
  loan_amortization:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_loan_amortization_type.columns.value
    update_flag: true
  loan_amortization_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_loan_amortization_type
    update_flag: true
  minimum_payment_rate_percent:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_minimum_payment_rate_percent
    update_flag: true
  minimum_rate_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_minimum_rate_term_months
    update_flag: true
  mortgage_type:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_mortgage_type.columns.value
    update_flag: true
  mortgage_type_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_mortgage_type
    update_flag: true
  negative_amortization:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_negative_amortization_type.columns.value
    update_flag: true
  negative_amortization_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_negative_amortization_type
    update_flag: true
  negative_amortization_limit_percent:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_negative_amortization_limit_percent
    update_flag: true
  negative_amortization_recast_period_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_negative_amortization_recast_period_months
    update_flag: true
  partial_payment_policy:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_partial_payment_policy_type.columns.value
    update_flag: true
  partial_payment_policy_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_partial_payment_policy_type
    update_flag: true
  payment_adjustment_lifetime_cap_percent:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_payment_adjustment_lifetime_cap_percent
    update_flag: true
  payment_adjustment_periodic_cap:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_payment_adjustment_periodic_cap
    update_flag: true
  payment_frequency:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_payment_frequency_type.columns.value
    update_flag: true
  payment_frequency_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_payment_frequency_type
    update_flag: true
  payment_structure:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_payment_structure_type.columns.value
    update_flag: true
  payment_structure_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_payment_structure_type
    update_flag: true
  prepaid_interest_rate:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_prepaid_interest_rate_type.columns.value
    update_flag: true
  prepaid_interest_rate_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_prepaid_interest_rate_type
    update_flag: true
  prepay_penalty:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_prepay_penalty_type.columns.value
    update_flag: true
  prepay_penalty_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_prepay_penalty_type
    update_flag: true
  product_appraisal_requirement:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_product_appraisal_requirement_type.columns.value
    update_flag: true
  product_appraisal_requirement_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_product_appraisal_requirement_type
    update_flag: true
  product_category:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_product_category
    update_flag: true
  product_special_program:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_product_special_program_type.columns.value
    update_flag: true
  product_special_program_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_product_special_program_type
    update_flag: true
  qualifying_monthly_payment:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_qualifying_monthly_payment_type.columns.value
    update_flag: true
  qualifying_monthly_payment_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_qualifying_monthly_payment_type
    update_flag: true
  qualifying_rate:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_qualifying_rate_type.columns.value
    update_flag: true
  qualifying_rate_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_qualifying_rate_type
    update_flag: true
  qualifying_rate_input_percent:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_qualifying_rate_input_percent
    update_flag: true
  rate_adjustment_lifetime_cap_percent:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_rate_adjustment_lifetime_cap_percent
    update_flag: true
  section_of_act_coarse:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_section_of_act_coarse_type.columns.value
    update_flag: true
  section_of_act_coarse_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_section_of_act_coarse_type
    update_flag: true
  security_instrument_page_count:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_security_instrument_page_count
    update_flag: true
  servicing_transfer:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_servicing_transfer_type.columns.value
    update_flag: true
  servicing_transfer_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_servicing_transfer_type
    update_flag: true
  subsequent_payment_adjustment_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_subsequent_payment_adjustment_term_months
    update_flag: true
  subsequent_rate_adjustment_cap_percent:
    data_type: NUMERIC(15,9)
    source:
      field: primary_source_table.columns.pt_subsequent_rate_adjustment_cap_percent
    update_flag: true
  subsequent_rate_adjustment_term_months:
    data_type: INTEGER
    source:
      field: primary_source_table.columns.pt_subsequent_rate_adjustment_term_months
    update_flag: true
  third_party_community_second_program_eligibility:
    data_type: VARCHAR(1024)
    source:
      field: primary_source_table.foreign_keys.fkt_pt_third_party_community_second_program_eligibility_type.columns.value
    update_flag: true
  third_party_community_second_program_eligibility_code:
    data_type: VARCHAR(128)
    source:
      field: primary_source_table.columns.pt_third_party_community_second_program_eligibility_type
    update_flag: true
etls:
  SP-200018:
    input_type: table
    output_type: insert_update
    hardcoded_data_source: Octane
    json_output_field: data_source_integration_id
    insert_update_keys:
      - data_source_integration_id
    container_memory: 4096
    input_sql: |-
      WITH product_terms_dim_incl_new_records AS (
          SELECT 'product_terms_pid' || '~' || 'data_source_dwid' AS data_source_integration_columns
               , COALESCE( CAST( primary_table.pt_pid AS TEXT ), '<NULL>' ) || '~' ||
                 COALESCE( CAST( 1 AS TEXT ), '<NULL>' ) AS data_source_integration_id
               , NOW( ) AS edw_created_datetime
               , NOW( ) AS edw_modified_datetime
               , primary_table.data_source_updated_datetime AS data_source_modified_datetime
               , t715.value AS arm_index
               , t717.value AS buydown_base_date
               , t718.value AS buydown_subsidy_calculation
               , t719.value AS community_lending
               , t720.value AS days_per_year
               , t721.value AS decision_credit_score_calc
               , t722.value AS fha_rehab_program
               , t723.value AS fha_special_program
               , t724.value AS fnm_arm_plan
               , t725.value AS fnm_community_lending_product
               , t726.value AS fre_community_program
               , t727.value AS heloc_cancel_fee_applicable
               , t729.value AS ipc_calc
               , t732.value AS ipc_comparison_operator3
               , t730.value AS ipc_comparison_operator1
               , t731.value AS ipc_comparison_operator2
               , t733.value AS ipc_comparison_operator4
               , t736.value AS ipc_property_usage3
               , t734.value AS ipc_property_usage1
               , t735.value AS ipc_property_usage2
               , t737.value AS ipc_property_usage4
               , t738.value AS lien_priority
               , t739.value AS loan_amortization
               , t740.value AS mortgage_type
               , t741.value AS negative_amortization
               , t742.value AS partial_payment_policy
               , t716.value AS arm_payment_adjustment_calculation
               , t743.value AS payment_frequency
               , t744.value AS payment_structure
               , t745.value AS prepaid_interest_rate
               , t746.value AS prepay_penalty
               , t747.value AS product_appraisal_requirement
               , t748.value AS product_special_program
               , primary_table.pt_ipc_comparison_operator_type3 AS ipc_comparison_operator_code3
               , primary_table.pt_ipc_cltv_ratio_percent3 AS ipc_cltv_ratio_percent3
               , primary_table.pt_ipc_limit_percent4 AS ipc_limit_percent4
               , primary_table.pt_ipc_property_usage_type4 AS ipc_property_usage_code4
               , primary_table.pt_ipc_comparison_operator_type4 AS ipc_comparison_operator_code4
               , primary_table.pt_ipc_cltv_ratio_percent4 AS ipc_cltv_ratio_percent4
               , primary_table.pt_buydown_base_date_type AS buydown_base_date_code
               , primary_table.pt_buydown_subsidy_calculation_type AS buydown_subsidy_calculation_code
               , primary_table.pt_prepaid_interest_rate_type AS prepaid_interest_rate_code
               , primary_table.pt_fnm_arm_plan_type AS fnm_arm_plan_code
               , primary_table.pt_dsi_plan_code AS dsi_plan_code
               , primary_table.pt_credit_qualifying AS credit_qualifying_flag
               , primary_table.pt_product_special_program_type AS product_special_program_code
               , primary_table.pt_section_of_act_coarse_type AS section_of_act_coarse_code
               , primary_table.pt_fha_rehab_program_type AS fha_rehab_program_code
               , primary_table.pt_fha_special_program_type AS fha_special_program_code
               , primary_table.pt_third_party_grant_eligible AS third_party_grant_eligible_flag
               , primary_table.pt_servicing_transfer_type AS servicing_transfer_code
               , primary_table.pt_no_mi_product AS no_mi_product_flag
               , primary_table.pt_mortgage_credit_certificate_eligible AS mortgage_credit_certificate_eligible_flag
               , primary_table.pt_fre_community_program_type AS fre_community_program_code
               , primary_table.pt_fnm_community_lending_product_type AS fnm_community_lending_product_code
               , primary_table.pt_zero_note_rate AS zero_note_rate_flag
               , primary_table.pt_third_party_community_second_program_eligibility_type AS third_party_community_second_program_eligibility_code
               , primary_table.pt_texas_veterans_land_board AS texas_veterans_land_board_code
               , primary_table.pt_security_instrument_page_count AS security_instrument_page_count
               , primary_table.pt_deed_page_count AS deed_page_count
               , primary_table.pt_partial_payment_policy_type AS partial_payment_policy_code
               , primary_table.pt_payment_structure_type AS payment_structure_code
               , primary_table.pt_deferred_payment_months AS deferred_payment_months
               , primary_table.pt_always_current_market_price AS always_current_market_price_flag
               , primary_table.pt_rate_protect AS rate_protect_flag
               , primary_table.pt_non_conforming AS non_conforming_flag
               , primary_table.pt_allow_loan_amount_cents AS allow_loan_amount_cents_flag
               , primary_table.pt_product_appraisal_requirement_type AS product_appraisal_requirement_code
               , primary_table.pt_family_advantage AS family_advantage_flag
               , primary_table.pt_community_lending_type AS community_lending_code
               , primary_table.pt_high_balance AS high_balance_code
               , primary_table.pt_decision_credit_score_calc_type AS decision_credit_score_calc_code
               , primary_table.pt_new_york AS new_york_flag
               , primary_table.pt_manual_risk_assessment_accepted AS manual_risk_assessment_accepted_flag
               , primary_table.pt_external_fha_underwrite_accepted AS external_fha_underwrite_accepted_flag
               , primary_table.pt_external_va_underwrite_accepted AS external_va_underwrite_accepted_flag
               , primary_table.pt_external_usda_underwrite_accepted AS external_usda_underwrite_accepted_flag
               , primary_table.pt_external_investor_underwrite_accepted AS external_investor_underwrite_accepted_flag
               , primary_table.pt_heloc_cancel_fee_applicable_type AS heloc_cancel_fee_applicable_code
               , primary_table.pt_heloc_cancel_fee_period_months AS heloc_cancel_fee_period_months
               , primary_table.pt_heloc_cancel_fee_amount AS heloc_cancel_fee_amount
               , primary_table.pt_heloc_draw_period_months AS heloc_draw_period_months
               , primary_table.pt_heloc_repayment_period_duration_months AS heloc_repayment_period_duration_months
               , primary_table.pt_heloc_maximum_initial_draw AS heloc_maximum_initial_draw_flag
               , primary_table.pt_heloc_maximum_initial_draw_amount AS heloc_maximum_initial_draw_amount
               , primary_table.pt_heloc_minimum_draw AS heloc_minimum_draw_flag
               , primary_table.pt_heloc_minimum_draw_amount AS heloc_minimum_draw_amount
               , primary_table.pt_gpm_adjustment_years AS gpm_adjustment_years
               , primary_table.pt_gpm_adjustment_percent AS gpm_adjustment_percent
               , primary_table.pt_qualifying_monthly_payment_type AS qualifying_monthly_payment_code
               , primary_table.pt_qualifying_rate_type AS qualifying_rate_code
               , primary_table.pt_qualifying_rate_input_percent AS qualifying_rate_input_percent
               , primary_table.pt_ipc_calc_type AS ipc_calc_code
               , primary_table.pt_ipc_limit_percent1 AS ipc_limit_percent1
               , primary_table.pt_ipc_property_usage_type1 AS ipc_property_usage_code1
               , primary_table.pt_ipc_comparison_operator_type1 AS ipc_comparison_operator_code1
               , primary_table.pt_ipc_cltv_ratio_percent1 AS ipc_cltv_ratio_percent1
               , primary_table.pt_ipc_limit_percent2 AS ipc_limit_percent2
               , primary_table.pt_ipc_property_usage_type2 AS ipc_property_usage_code2
               , primary_table.pt_ipc_comparison_operator_type2 AS ipc_comparison_operator_code2
               , primary_table.pt_ipc_cltv_ratio_percent2 AS ipc_cltv_ratio_percent2
               , primary_table.pt_ipc_limit_percent3 AS ipc_limit_percent3
               , primary_table.pt_ipc_property_usage_type3 AS ipc_property_usage_code3
               , primary_table.pt_pid AS product_terms_pid
               , primary_table.pt_amortization_term_months AS amortization_term_months
               , primary_table.pt_arm_index_type AS arm_index_code
               , primary_table.pt_arm_payment_adjustment_calculation_type AS arm_payment_adjustment_calculation_code
               , primary_table.pt_assumable AS assumable_flag
               , primary_table.pt_product_category AS product_category
               , primary_table.pt_conditions_to_assumability AS conditions_to_assumability_flag
               , primary_table.pt_demand_feature AS demand_feature_flag
               , primary_table.pt_due_in_term_months AS due_in_term_months
               , primary_table.pt_escrow_cushion_months AS escrow_cushion_months
               , primary_table.pt_from_date AS from_date
               , primary_table.pt_initial_payment_adjustment_term_months AS initial_payment_adjustment_term_months
               , primary_table.pt_initial_rate_adjustment_cap_percent AS initial_rate_adjustment_cap_percent
               , primary_table.pt_initial_rate_adjustment_term_months AS initial_rate_adjustment_term_months
               , primary_table.pt_lien_priority_type AS lien_priority_code
               , primary_table.pt_loan_amortization_type AS loan_amortization_code
               , primary_table.pt_minimum_payment_rate_percent AS minimum_payment_rate_percent
               , primary_table.pt_minimum_rate_term_months AS minimum_rate_term_months
               , primary_table.pt_mortgage_type AS mortgage_type_code
               , primary_table.pt_negative_amortization_type AS negative_amortization_code
               , primary_table.pt_negative_amortization_limit_percent AS negative_amortization_limit_percent
               , primary_table.pt_negative_amortization_recast_period_months AS negative_amortization_recast_period_months
               , primary_table.pt_payment_adjustment_lifetime_cap_percent AS payment_adjustment_lifetime_cap_percent
               , primary_table.pt_payment_adjustment_periodic_cap AS payment_adjustment_periodic_cap
               , primary_table.pt_payment_frequency_type AS payment_frequency_code
               , primary_table.pt_prepayment_finance_charge_refund AS prepayment_charge_refund_flag
               , primary_table.pt_product_pid AS product_pid
               , primary_table.pt_rate_adjustment_lifetime_cap_percent AS rate_adjustment_lifetime_cap_percent
               , primary_table.pt_subsequent_payment_adjustment_term_months AS subsequent_payment_adjustment_term_months
               , primary_table.pt_subsequent_rate_adjustment_cap_percent AS subsequent_rate_adjustment_cap_percent
               , primary_table.pt_subsequent_rate_adjustment_term_months AS subsequent_rate_adjustment_term_months
               , primary_table.pt_prepay_penalty_type AS prepay_penalty_code
               , primary_table.pt_lender_hazard_insurance_available AS lender_hazard_insurance_available_flag
               , primary_table.pt_lender_hazard_insurance_premium_amount AS lender_hazard_insurance_premium_amount
               , primary_table.pt_lender_hazard_insurance_term_months AS lender_hazard_insurance_term_months
               , primary_table.pt_loan_requires_hazard_insurance AS loan_requires_hazard_insurance_flag
               , primary_table.pt_arm_convertible AS arm_convertible_flag
               , primary_table.pt_arm_convertible_from_month AS arm_convertible_from_month
               , primary_table.pt_arm_convertible_through_month AS arm_convertible_through_month
               , primary_table.pt_arm_floor_rate_percent AS arm_floor_rate_percent
               , primary_table.pt_arm_lookback_period_days AS arm_lookback_period_days
               , primary_table.pt_escrow_waiver_allowed AS escrow_waiver_allowed_flag
               , primary_table.pt_days_per_year_type AS days_per_year_code
               , primary_table.pt_lp_risk_assessment_accepted AS lp_risk_assessment_accepted_flag
               , primary_table.pt_du_risk_assessment_accepted AS du_risk_assessment_accepted_flag
               , primary_table.pt_internal_underwrite_accepted AS internal_underwrite_accepted_flag
               , t749.value AS qualifying_monthly_payment
               , t750.value AS qualifying_rate
               , t751.value AS section_of_act_coarse
               , t752.value AS servicing_transfer
               , t754.value AS third_party_community_second_program_eligibility
               , t753.value AS texas_veterans_land_board
               , t728.value AS high_balance
               , GREATEST( primary_table.etl_end_date_time, t715.etl_end_date_time, t717.etl_end_date_time, t718.etl_end_date_time,
                           t719.etl_end_date_time, t720.etl_end_date_time, t721.etl_end_date_time, t722.etl_end_date_time, t723.etl_end_date_time,
                           t724.etl_end_date_time, t725.etl_end_date_time, t726.etl_end_date_time, t727.etl_end_date_time, t729.etl_end_date_time,
                           t732.etl_end_date_time, t730.etl_end_date_time, t731.etl_end_date_time, t733.etl_end_date_time, t736.etl_end_date_time,
                           t734.etl_end_date_time, t735.etl_end_date_time, t737.etl_end_date_time, t738.etl_end_date_time, t739.etl_end_date_time,
                           t740.etl_end_date_time, t741.etl_end_date_time, t742.etl_end_date_time, t716.etl_end_date_time, t743.etl_end_date_time,
                           t744.etl_end_date_time, t745.etl_end_date_time, t746.etl_end_date_time, t747.etl_end_date_time, t748.etl_end_date_time,
                           t749.etl_end_date_time, t750.etl_end_date_time, t751.etl_end_date_time, t752.etl_end_date_time, t754.etl_end_date_time,
                           t753.etl_end_date_time, t728.etl_end_date_time ) AS max_source_etl_end_date_time
          FROM (
              SELECT <<product_terms_partial_load_condition>> AS include_record
                   , product_terms.*
                   , etl_log.etl_end_date_time
              FROM history_octane.product_terms
              LEFT JOIN history_octane.product_terms AS history_records
                        ON product_terms.pt_pid = history_records.pt_pid
                            AND product_terms.data_source_updated_datetime < history_records.data_source_updated_datetime
              JOIN star_common.etl_log
                   ON product_terms.etl_batch_id = etl_log.etl_batch_id
              WHERE history_records.pt_pid IS NULL
          ) AS primary_table
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<arm_index_type_partial_load_condition>> AS include_record
                       , arm_index_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.arm_index_type
                  LEFT JOIN history_octane.arm_index_type AS history_records
                            ON arm_index_type.code = history_records.code
                                AND arm_index_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON arm_index_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t715
                     ON primary_table.pt_arm_index_type = t715.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<buydown_base_date_type_partial_load_condition>> AS include_record
                       , buydown_base_date_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.buydown_base_date_type
                  LEFT JOIN history_octane.buydown_base_date_type AS history_records
                            ON buydown_base_date_type.code = history_records.code
                                AND buydown_base_date_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON buydown_base_date_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t717
                     ON primary_table.pt_buydown_base_date_type = t717.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<buydown_subsidy_calculation_type_partial_load_condition>> AS include_record
                       , buydown_subsidy_calculation_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.buydown_subsidy_calculation_type
                  LEFT JOIN history_octane.buydown_subsidy_calculation_type AS history_records
                            ON buydown_subsidy_calculation_type.code = history_records.code
                                AND buydown_subsidy_calculation_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON buydown_subsidy_calculation_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t718
                     ON primary_table.pt_buydown_subsidy_calculation_type = t718.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<community_lending_type_partial_load_condition>> AS include_record
                       , community_lending_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.community_lending_type
                  LEFT JOIN history_octane.community_lending_type AS history_records
                            ON community_lending_type.code = history_records.code
                                AND community_lending_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON community_lending_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t719
                     ON primary_table.pt_community_lending_type = t719.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<days_per_year_type_partial_load_condition>> AS include_record
                       , days_per_year_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.days_per_year_type
                  LEFT JOIN history_octane.days_per_year_type AS history_records
                            ON days_per_year_type.code = history_records.code
                                AND days_per_year_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON days_per_year_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t720
                     ON primary_table.pt_days_per_year_type = t720.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<decision_credit_score_calc_type_partial_load_condition>> AS include_record
                       , decision_credit_score_calc_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.decision_credit_score_calc_type
                  LEFT JOIN history_octane.decision_credit_score_calc_type AS history_records
                            ON decision_credit_score_calc_type.code = history_records.code
                                AND decision_credit_score_calc_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON decision_credit_score_calc_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t721
                     ON primary_table.pt_decision_credit_score_calc_type = t721.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<fha_rehab_program_type_partial_load_condition>> AS include_record
                       , fha_rehab_program_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.fha_rehab_program_type
                  LEFT JOIN history_octane.fha_rehab_program_type AS history_records
                            ON fha_rehab_program_type.code = history_records.code
                                AND fha_rehab_program_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON fha_rehab_program_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t722
                     ON primary_table.pt_fha_rehab_program_type = t722.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<fha_special_program_type_partial_load_condition>> AS include_record
                       , fha_special_program_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.fha_special_program_type
                  LEFT JOIN history_octane.fha_special_program_type AS history_records
                            ON fha_special_program_type.code = history_records.code
                                AND fha_special_program_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON fha_special_program_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t723
                     ON primary_table.pt_fha_special_program_type = t723.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<fnm_arm_plan_type_partial_load_condition>> AS include_record
                       , fnm_arm_plan_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.fnm_arm_plan_type
                  LEFT JOIN history_octane.fnm_arm_plan_type AS history_records
                            ON fnm_arm_plan_type.code = history_records.code
                                AND fnm_arm_plan_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON fnm_arm_plan_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t724
                     ON primary_table.pt_fnm_arm_plan_type = t724.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<fnm_community_lending_product_type_partial_load_condition>> AS include_record
                       , fnm_community_lending_product_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.fnm_community_lending_product_type
                  LEFT JOIN history_octane.fnm_community_lending_product_type AS history_records
                            ON fnm_community_lending_product_type.code = history_records.code
                                AND fnm_community_lending_product_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON fnm_community_lending_product_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t725
                     ON primary_table.pt_fnm_community_lending_product_type = t725.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<fre_community_program_type_partial_load_condition>> AS include_record
                       , fre_community_program_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.fre_community_program_type
                  LEFT JOIN history_octane.fre_community_program_type AS history_records
                            ON fre_community_program_type.code = history_records.code
                                AND fre_community_program_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON fre_community_program_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t726
                     ON primary_table.pt_fre_community_program_type = t726.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<heloc_cancel_fee_applicable_type_partial_load_condition>> AS include_record
                       , heloc_cancel_fee_applicable_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.heloc_cancel_fee_applicable_type
                  LEFT JOIN history_octane.heloc_cancel_fee_applicable_type AS history_records
                            ON heloc_cancel_fee_applicable_type.code = history_records.code
                                AND heloc_cancel_fee_applicable_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON heloc_cancel_fee_applicable_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t727
                     ON primary_table.pt_heloc_cancel_fee_applicable_type = t727.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<ipc_calc_type_partial_load_condition>> AS include_record
                       , ipc_calc_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.ipc_calc_type
                  LEFT JOIN history_octane.ipc_calc_type AS history_records
                            ON ipc_calc_type.code = history_records.code
                                AND ipc_calc_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON ipc_calc_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t729
                     ON primary_table.pt_ipc_calc_type = t729.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<ipc_comparison_operator_type_partial_load_condition>> AS include_record
                       , ipc_comparison_operator_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.ipc_comparison_operator_type
                  LEFT JOIN history_octane.ipc_comparison_operator_type AS history_records
                            ON ipc_comparison_operator_type.code = history_records.code
                                AND ipc_comparison_operator_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON ipc_comparison_operator_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t732
                     ON primary_table.pt_ipc_comparison_operator_type3 = t732.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<ipc_comparison_operator_type_partial_load_condition>> AS include_record
                       , ipc_comparison_operator_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.ipc_comparison_operator_type
                  LEFT JOIN history_octane.ipc_comparison_operator_type AS history_records
                            ON ipc_comparison_operator_type.code = history_records.code
                                AND ipc_comparison_operator_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON ipc_comparison_operator_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t730
                     ON primary_table.pt_ipc_comparison_operator_type1 = t730.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<ipc_comparison_operator_type_partial_load_condition>> AS include_record
                       , ipc_comparison_operator_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.ipc_comparison_operator_type
                  LEFT JOIN history_octane.ipc_comparison_operator_type AS history_records
                            ON ipc_comparison_operator_type.code = history_records.code
                                AND ipc_comparison_operator_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON ipc_comparison_operator_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t731
                     ON primary_table.pt_ipc_comparison_operator_type2 = t731.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<ipc_comparison_operator_type_partial_load_condition>> AS include_record
                       , ipc_comparison_operator_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.ipc_comparison_operator_type
                  LEFT JOIN history_octane.ipc_comparison_operator_type AS history_records
                            ON ipc_comparison_operator_type.code = history_records.code
                                AND ipc_comparison_operator_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON ipc_comparison_operator_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t733
                     ON primary_table.pt_ipc_comparison_operator_type4 = t733.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<ipc_property_usage_type_partial_load_condition>> AS include_record
                       , ipc_property_usage_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.ipc_property_usage_type
                  LEFT JOIN history_octane.ipc_property_usage_type AS history_records
                            ON ipc_property_usage_type.code = history_records.code
                                AND ipc_property_usage_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON ipc_property_usage_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t736
                     ON primary_table.pt_ipc_property_usage_type3 = t736.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<ipc_property_usage_type_partial_load_condition>> AS include_record
                       , ipc_property_usage_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.ipc_property_usage_type
                  LEFT JOIN history_octane.ipc_property_usage_type AS history_records
                            ON ipc_property_usage_type.code = history_records.code
                                AND ipc_property_usage_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON ipc_property_usage_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t734
                     ON primary_table.pt_ipc_property_usage_type1 = t734.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<ipc_property_usage_type_partial_load_condition>> AS include_record
                       , ipc_property_usage_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.ipc_property_usage_type
                  LEFT JOIN history_octane.ipc_property_usage_type AS history_records
                            ON ipc_property_usage_type.code = history_records.code
                                AND ipc_property_usage_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON ipc_property_usage_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t735
                     ON primary_table.pt_ipc_property_usage_type2 = t735.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<ipc_property_usage_type_partial_load_condition>> AS include_record
                       , ipc_property_usage_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.ipc_property_usage_type
                  LEFT JOIN history_octane.ipc_property_usage_type AS history_records
                            ON ipc_property_usage_type.code = history_records.code
                                AND ipc_property_usage_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON ipc_property_usage_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t737
                     ON primary_table.pt_ipc_property_usage_type4 = t737.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<lien_priority_type_partial_load_condition>> AS include_record
                       , lien_priority_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.lien_priority_type
                  LEFT JOIN history_octane.lien_priority_type AS history_records
                            ON lien_priority_type.code = history_records.code
                                AND lien_priority_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON lien_priority_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t738
                     ON primary_table.pt_lien_priority_type = t738.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<loan_amortization_type_partial_load_condition>> AS include_record
                       , loan_amortization_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.loan_amortization_type
                  LEFT JOIN history_octane.loan_amortization_type AS history_records
                            ON loan_amortization_type.code = history_records.code
                                AND loan_amortization_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON loan_amortization_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t739
                     ON primary_table.pt_loan_amortization_type = t739.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<mortgage_type_partial_load_condition>> AS include_record
                       , mortgage_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.mortgage_type
                  LEFT JOIN history_octane.mortgage_type AS history_records
                            ON mortgage_type.code = history_records.code
                                AND mortgage_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON mortgage_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t740
                     ON primary_table.pt_mortgage_type = t740.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<negative_amortization_type_partial_load_condition>> AS include_record
                       , negative_amortization_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.negative_amortization_type
                  LEFT JOIN history_octane.negative_amortization_type AS history_records
                            ON negative_amortization_type.code = history_records.code
                                AND negative_amortization_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON negative_amortization_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t741
                     ON primary_table.pt_negative_amortization_type = t741.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<partial_payment_policy_type_partial_load_condition>> AS include_record
                       , partial_payment_policy_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.partial_payment_policy_type
                  LEFT JOIN history_octane.partial_payment_policy_type AS history_records
                            ON partial_payment_policy_type.code = history_records.code
                                AND partial_payment_policy_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON partial_payment_policy_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t742
                     ON primary_table.pt_partial_payment_policy_type = t742.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<payment_adjustment_calculation_type_partial_load_condition>> AS include_record
                       , payment_adjustment_calculation_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.payment_adjustment_calculation_type
                  LEFT JOIN history_octane.payment_adjustment_calculation_type AS history_records
                            ON payment_adjustment_calculation_type.code = history_records.code
                                AND
                               payment_adjustment_calculation_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON payment_adjustment_calculation_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t716
                     ON primary_table.pt_arm_payment_adjustment_calculation_type = t716.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<payment_frequency_type_partial_load_condition>> AS include_record
                       , payment_frequency_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.payment_frequency_type
                  LEFT JOIN history_octane.payment_frequency_type AS history_records
                            ON payment_frequency_type.code = history_records.code
                                AND payment_frequency_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON payment_frequency_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t743
                     ON primary_table.pt_payment_frequency_type = t743.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<payment_structure_type_partial_load_condition>> AS include_record
                       , payment_structure_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.payment_structure_type
                  LEFT JOIN history_octane.payment_structure_type AS history_records
                            ON payment_structure_type.code = history_records.code
                                AND payment_structure_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON payment_structure_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t744
                     ON primary_table.pt_payment_structure_type = t744.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<prepaid_interest_rate_type_partial_load_condition>> AS include_record
                       , prepaid_interest_rate_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.prepaid_interest_rate_type
                  LEFT JOIN history_octane.prepaid_interest_rate_type AS history_records
                            ON prepaid_interest_rate_type.code = history_records.code
                                AND prepaid_interest_rate_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON prepaid_interest_rate_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t745
                     ON primary_table.pt_prepaid_interest_rate_type = t745.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<prepay_penalty_type_partial_load_condition>> AS include_record
                       , prepay_penalty_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.prepay_penalty_type
                  LEFT JOIN history_octane.prepay_penalty_type AS history_records
                            ON prepay_penalty_type.code = history_records.code
                                AND prepay_penalty_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON prepay_penalty_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t746
                     ON primary_table.pt_prepay_penalty_type = t746.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<product_appraisal_requirement_type_partial_load_condition>> AS include_record
                       , product_appraisal_requirement_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.product_appraisal_requirement_type
                  LEFT JOIN history_octane.product_appraisal_requirement_type AS history_records
                            ON product_appraisal_requirement_type.code = history_records.code
                                AND product_appraisal_requirement_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON product_appraisal_requirement_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t747
                     ON primary_table.pt_product_appraisal_requirement_type = t747.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<product_special_program_type_partial_load_condition>> AS include_record
                       , product_special_program_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.product_special_program_type
                  LEFT JOIN history_octane.product_special_program_type AS history_records
                            ON product_special_program_type.code = history_records.code
                                AND product_special_program_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON product_special_program_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t748
                     ON primary_table.pt_product_special_program_type = t748.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<qualifying_monthly_payment_type_partial_load_condition>> AS include_record
                       , qualifying_monthly_payment_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.qualifying_monthly_payment_type
                  LEFT JOIN history_octane.qualifying_monthly_payment_type AS history_records
                            ON qualifying_monthly_payment_type.code = history_records.code
                                AND qualifying_monthly_payment_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON qualifying_monthly_payment_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t749
                     ON primary_table.pt_qualifying_monthly_payment_type = t749.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<qualifying_rate_type_partial_load_condition>> AS include_record
                       , qualifying_rate_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.qualifying_rate_type
                  LEFT JOIN history_octane.qualifying_rate_type AS history_records
                            ON qualifying_rate_type.code = history_records.code
                                AND qualifying_rate_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON qualifying_rate_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t750
                     ON primary_table.pt_qualifying_rate_type = t750.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<section_of_act_coarse_type_partial_load_condition>> AS include_record
                       , section_of_act_coarse_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.section_of_act_coarse_type
                  LEFT JOIN history_octane.section_of_act_coarse_type AS history_records
                            ON section_of_act_coarse_type.code = history_records.code
                                AND section_of_act_coarse_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON section_of_act_coarse_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t751
                     ON primary_table.pt_section_of_act_coarse_type = t751.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<servicing_transfer_type_partial_load_condition>> AS include_record
                       , servicing_transfer_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.servicing_transfer_type
                  LEFT JOIN history_octane.servicing_transfer_type AS history_records
                            ON servicing_transfer_type.code = history_records.code
                                AND servicing_transfer_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON servicing_transfer_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t752
                     ON primary_table.pt_servicing_transfer_type = t752.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<third_party_community_second_program_eligibility_type_partial_load_condition>> AS include_record
                       , third_party_community_second_program_eligibility_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.third_party_community_second_program_eligibility_type
                  LEFT JOIN history_octane.third_party_community_second_program_eligibility_type AS history_records
                            ON third_party_community_second_program_eligibility_type.code = history_records.code
                                AND third_party_community_second_program_eligibility_type.data_source_updated_datetime <
                                    history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON third_party_community_second_program_eligibility_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t754
                     ON primary_table.pt_third_party_community_second_program_eligibility_type = t754.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<yes_no_unknown_type_partial_load_condition>> AS include_record
                       , yes_no_unknown_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.yes_no_unknown_type
                  LEFT JOIN history_octane.yes_no_unknown_type AS history_records
                            ON yes_no_unknown_type.code = history_records.code
                                AND yes_no_unknown_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON yes_no_unknown_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t753
                     ON primary_table.pt_texas_veterans_land_board = t753.code
          INNER JOIN (
              SELECT *
              FROM (
                  SELECT <<yes_no_na_unknown_type_partial_load_condition>> AS include_record
                       , yes_no_na_unknown_type.*
                       , etl_log.etl_end_date_time
                  FROM history_octane.yes_no_na_unknown_type
                  LEFT JOIN history_octane.yes_no_na_unknown_type AS history_records
                            ON yes_no_na_unknown_type.code = history_records.code
                                AND yes_no_na_unknown_type.data_source_updated_datetime < history_records.data_source_updated_datetime
                  JOIN star_common.etl_log
                       ON yes_no_na_unknown_type.etl_batch_id = etl_log.etl_batch_id
                  WHERE history_records.code IS NULL
              ) AS primary_table
          ) AS t728
                     ON primary_table.pt_high_balance = t728.code
          WHERE GREATEST( primary_table.include_record, t715.include_record, t717.include_record, t718.include_record, t719.include_record,
                          t720.include_record, t721.include_record, t722.include_record, t723.include_record, t724.include_record,
                          t725.include_record, t726.include_record, t727.include_record, t729.include_record, t732.include_record,
                          t730.include_record, t731.include_record, t733.include_record, t736.include_record, t734.include_record,
                          t735.include_record, t737.include_record, t738.include_record, t739.include_record, t740.include_record,
                          t741.include_record, t742.include_record, t716.include_record, t743.include_record, t744.include_record,
                          t745.include_record, t746.include_record, t747.include_record, t748.include_record, t749.include_record,
                          t750.include_record, t751.include_record, t752.include_record, t754.include_record, t753.include_record,
                          t728.include_record ) IS TRUE
      )
      --new records that should be inserted
      SELECT product_terms_dim_incl_new_records.*
      FROM product_terms_dim_incl_new_records
      LEFT JOIN star_loan.product_terms_dim
                ON product_terms_dim_incl_new_records.data_source_integration_id = product_terms_dim.data_source_integration_id
      WHERE product_terms_dim.dwid IS NULL
      UNION ALL
      --existing records that need to be updated
      SELECT product_terms_dim_incl_new_records.*
      FROM product_terms_dim_incl_new_records
      JOIN (
          SELECT product_terms_dim.data_source_integration_id, etl_log.etl_start_date_time
          FROM star_loan.product_terms_dim
          JOIN star_common.etl_log
               ON product_terms_dim.etl_batch_id = etl_log.etl_batch_id
      ) AS product_terms_dim_etl_start_times
           ON product_terms_dim_incl_new_records.data_source_integration_id = product_terms_dim_etl_start_times.data_source_integration_id
               AND product_terms_dim_incl_new_records.max_source_etl_end_date_time >= product_terms_dim_etl_start_times.etl_start_date_time;
next_etls:
  - SP-300001-insert-update
